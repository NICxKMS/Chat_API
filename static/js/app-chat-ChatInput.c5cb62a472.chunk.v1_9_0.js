"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([["app-chat-ChatInput"],{6682:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var i=n(85908),l=n(73420),r=n(33804),o=n(54860),a=n(42379),s=n(43996),c=n(44440);const u=e=>{let{images:t,onRemoveImage:n}=e;return t&&0!==t.length?(0,c.Y)("div",{className:s.A.imagePreviewContainer,children:t.map(((e,t)=>(0,c.FD)("div",{className:s.A.imagePreviewWrapper,children:[(0,c.Y)("img",{src:e.url,alt:`preview ${t}`,className:s.A.imagePreview}),(0,c.Y)("button",{className:s.A.removeImageButton,onClick:()=>n(t),"aria-label":`Remove image ${t+1}`,title:`Remove image ${t+1}`,children:(0,c.Y)(a.uv5,{size:12})})]},t)))}):null},h=i.Ay.memo(u);var d=n(83404);const g=(0,i.Rf)(((e,t)=>{let{value:n,onChange:i,onKeyDown:l,onPaste:r,placeholder:o,disabled:s=!1,isEditing:u=!1,isWaitingForResponse:h=!1,selectedModel:g=null,onSendClick:m}=e;const p=h?"Stop generation":g?u?"Save edit":"Send message":"Select model",v=h?"Stop generation":g?u?"Save edit (Enter)":"Send message (Enter)":"Select a model";return(0,c.FD)("div",{className:`${d.A.ChatInput__inputWrapper} ${g?"":d.A.noModelSelected}`,children:[(0,c.Y)("textarea",{ref:t,className:d.A.ChatInput__chatInput,placeholder:o,value:n,onChange:i,onKeyDown:l,onPaste:r,disabled:s,rows:1,"aria-label":"Chat message input"}),(0,c.Y)("button",{className:`${d.A.ChatInput__sendButtonInline} ${h?d.A.ChatInput__stopButton:""} ${g?"":d.A.noModelSelected}`,onClick:m,disabled:!h&&(!(null!=n&&n.trim())||s),"aria-label":p,title:v,type:"button",children:h?(0,c.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"21",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,c.Y)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}):g?u?(0,c.Y)(a.Srz,{size:21}):(0,c.Y)(a.GD3,{size:21}):(0,c.FD)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.Y)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})}));g.displayName="ChatInputTextArea";const m=g;var p=n(63002);const v=e=>{var t,n,i;let{isMobile:l=!1,isEditing:r=!1,disabled:o=!1,selectedModel:s=null,onNewChat:u,onUploadClick:h,onCancelEdit:d,onToggleModelSelector:g}=e;return(0,c.FD)("div",{className:p.A.ChatInput__actionRow,children:[(0,c.FD)("div",{className:p.A.ChatInput__leftButtons,children:[(0,c.Y)("button",{className:p.A.ChatInput__uploadButton,onClick:h,disabled:o||!(null!=s&&null!==(t=s.capabilities)&&void 0!==t&&t.includes("vision")),"aria-label":null!=s&&null!==(n=s.capabilities)&&void 0!==n&&n.includes("vision")?"Upload images":"Select a model with vision capabilities",title:null!=s&&null!==(i=s.capabilities)&&void 0!==i&&i.includes("vision")?"Upload images":"Select a model with vision capabilities",type:"button",children:(0,c.Y)(a.xfq,{size:16})}),(0,c.FD)("button",{className:`${p.A.ChatInput__textButton} ${l?p.A.ChatInput__iconOnlyButton:""}`,"aria-label":"Search",title:"Search (coming soon)",type:"button",disabled:!0,children:[(0,c.Y)(a.WIv,{size:16}),!l&&(0,c.Y)("span",{className:p.A.buttonText,children:"Search"})]}),(0,c.FD)("button",{className:`${p.A.ChatInput__textButton} ${l?p.A.ChatInput__iconOnlyButton:""}`,"aria-label":"Reason mode",title:"Reason mode (coming soon)",type:"button",disabled:!0,children:[(0,c.Y)(a.XLj,{size:16}),!l&&(0,c.Y)("span",{className:p.A.buttonText,children:"Reason"})]}),(0,c.Y)("button",{className:p.A.ChatInput__actionButton,"aria-label":"More options",title:"More options (coming soon)",type:"button",disabled:!0,children:(0,c.Y)(a.tno,{size:16})})]}),(0,c.FD)("div",{className:p.A.ChatInput__rightButtons,children:[(0,c.Y)("button",{className:p.A.ChatInput__actionButton,onClick:u,"aria-label":"New chat",title:"New chat",type:"button",children:(0,c.Y)(a.c11,{size:16})}),r&&(0,c.Y)("button",{className:p.A.ChatInput__uploadButton,onClick:d,"aria-label":"Cancel edit",title:"Cancel edit (Esc)",type:"button",children:(0,c.Y)(a.uv5,{size:16})}),(0,c.Y)("button",{className:p.A.ChatInput__modelButton,onClick:g,"aria-label":"Select AI model",title:"Select AI model",type:"button",children:(0,c.FD)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.Y)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.Y)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})]})},w=i.Ay.memo(v),b=e=>new Promise(((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=e=>n(e),i.readAsDataURL(e)})),y=(0,i.ph)((e=>{let{disabled:t=!1,selectedModel:n=null,isStaticLayout:a=!1,editingMessage:s=null,onCancelEdit:u=()=>{},isStreaming:d=!1,toggleModelSelector:g=()=>{},onFocus:p=()=>{},isInitialChat:v=!1,onSendMessage:y}=e;const[C,f]=(0,i.J0)(""),[Y,_]=(0,i.J0)([]),x=(0,i.li)(null),A=(0,i.li)(null),I=!!s,[E,N]=(0,i.J0)(window.innerWidth<=600),{isWaitingForResponse:S}=(0,r.P)(),{stopGeneration:k,newChat:M}=(0,o.r)(),[D,B]=(0,i.J0)(null),F=(0,i.li)(null);(0,i.vJ)((()=>{const e=()=>N(window.innerWidth<=600);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,i.vJ)((()=>{var e;null===(e=x.current)||void 0===e||e.focus()}),[]),(0,i.vJ)((()=>{if(s){let e="";const t=[];"string"==typeof s.content?e=s.content:Array.isArray(s.content)&&s.content.forEach((n=>{var i;"text"===n.type&&(e+=n.text||""),"image_url"===n.type&&null!==(i=n.image_url)&&void 0!==i&&i.url&&t.push({name:"",url:n.image_url.url})})),f(e),_(t),setTimeout((()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.focus()}),0)}else f(""),_([])}),[s]);const $=(0,i.hb)((()=>{const e=x.current;if(!e)return;let t;e.style.height="auto",t=E?Math.min(e.scrollHeight+2,200):Math.max(48,Math.min(e.scrollHeight+2,200)),e.style.height=`${t}px`;const n=e.closest(`.${l.A.ChatInput}`);n&&n.style.setProperty("--textarea-height",`${t}px`)}),[E]);(0,i.vJ)((()=>{$()}),[C,$]),(0,i.vJ)((()=>{if(!E)return;const e=()=>{const e=window.innerHeight<.75*window.outerHeight;document.body.classList.toggle("keyboard-open",e)},t=()=>{E&&(document.body.classList.add("keyboard-open"),window.addEventListener("resize",e)),p&&p()},n=()=>{E&&(document.body.classList.remove("keyboard-open"),window.removeEventListener("resize",e))},i=x.current;return i&&(i.addEventListener("focus",t),i.addEventListener("blur",n)),()=>{i&&(i.removeEventListener("focus",t),i.removeEventListener("blur",n)),window.removeEventListener("resize",e),document.body.classList.remove("keyboard-open")}}),[E,p]);const L=(0,i.hb)((e=>{B(e),F.current&&clearTimeout(F.current),F.current=setTimeout((()=>{B(null),F.current=null}),3e3)}),[]);(0,i.vJ)((()=>()=>{F.current&&clearTimeout(F.current)}),[]);const z=(0,i.hb)((e=>{f(e.target.value)}),[]),R=(0,i.hb)((()=>{const e=C.trim().length>0,i=Y.length>0;if(!e&&!i||t)return;if(!n&&g)return void g();const l=[];e&&l.push({type:"text",text:C.trim()}),i&&Y.forEach((e=>l.push({type:"image_url",image_url:{url:e.url}}))),l.length>0&&y(l,I?s:null),f(""),_([]),I&&u&&u(),x.current&&(x.current.style.height="auto",setTimeout((()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.focus()}),0))}),[C,Y,t,n,g,y,I,s,u]),P=(0,i.hb)((e=>{"Enter"!==e.key||e.shiftKey?I&&"Escape"===e.key&&(e.preventDefault(),u&&u(),f(""),_([])):(e.preventDefault(),S||R())}),[S,R,I,u]),W=(0,i.hb)((async e=>{const t=Array.from(e.target.files);if(t.length){if(Y.length+t.length>5)return L("Max 5 images allowed."),void(A.current&&(A.current.value=""));try{const e=t.map((async e=>{if(!e.type.startsWith("image/"))throw new Error(`${e.name} invalid type.`);if(e.size>5242880)throw new Error(`${e.name} > 5MB.`);const t=await b(e);return{name:e.name,url:t}})),n=await Promise.all(e);_((e=>[...e,...n]))}catch(n){L(`Image error: ${n.message}`)}A.current&&(A.current.value="")}}),[Y.length,L]),T=(0,i.hb)((async e=>{var t;if(I)return;const n=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!n)return;const i=Array.from(n).filter((e=>e.type.startsWith("image/")));if(0!==i.length)if(Y.length+i.length>5)L("Max 5 images allowed.");else try{const t=i.map((async e=>{const t=e.getAsFile();if(t.size>5242880)throw new Error("Pasted image > 5MB.");const n=await b(t);return{name:"pasted-"+Date.now(),url:n}})),n=await Promise.all(t);n.length>0&&(_((e=>[...e,...n])),e.preventDefault())}catch(l){L(`Paste error: ${l.message}`)}}),[I,Y.length,L]),J=(0,i.hb)((e=>{_((t=>t.filter(((t,n)=>n!==e))))}),[]),K=(0,i.hb)((()=>{var e;if(!n&&g)g();else if(null!=n&&null!==(e=n.capabilities)&&void 0!==e&&e.includes("vision")){var t;null===(t=A.current)||void 0===t||t.click()}else L("Select a model with vision capabilities to upload images.")}),[n,g,L]),U=(0,i.hb)((()=>{u&&u(),f(""),_([])}),[u]),j=(0,i.hb)((()=>{k()}),[k]),H=(0,i.hb)((e=>{e.preventDefault(),e.stopPropagation(),S?j():R(),E&&x.current&&x.current.blur()}),[S,j,R,E]),G=I?"Edit your message...":S?"Type your next message while waiting...":"Ask anything";return(0,c.FD)(c.FK,{children:[(0,c.Y)(h,{images:Y,onRemoveImage:J}),(0,c.FD)("div",{className:[l.A.ChatInput,I?l.A["ChatInput--editing"]:"",S?l.A["ChatInput--waitingForResponse"]:"",E?l.A.ChatInput__mobileView:"",E?v?l.A["ChatInput--mobileInitial"]:l.A["ChatInput--mobileWithMessages"]:""].filter(Boolean).join(" "),children:[D&&(0,c.Y)("div",{className:l.A.ChatInput__error,role:"alert",children:D}),(0,c.Y)("input",{type:"file",ref:A,style:{display:"none"},accept:"image/jpeg, image/png, image/gif, image/webp",multiple:!0,onChange:W}),(0,c.Y)(m,{ref:x,value:C,onChange:z,onKeyDown:P,onPaste:T,placeholder:G,disabled:t,isEditing:I,isWaitingForResponse:S,selectedModel:n,onSendClick:H}),(0,c.Y)(w,{isMobile:E,isEditing:I,disabled:t,selectedModel:n,onNewChat:M,onUploadClick:K,onCancelEdit:U,onToggleModelSelector:g})]})]})}));y.displayName="ChatInput";const C=y}}]);
//# sourceMappingURL=app-chat-ChatInput.c5cb62a472.chunk.v1_9_0.js.map