"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([["app-large-8367718c"],{1681:(e,t,o)=>{o.d(t,{M3:()=>i,oo:()=>s});var n=o(85908),l=o(44440);const r=(0,n.q6)(null),s=e=>{let{children:t}=e;const[o,s]=(0,n.J0)({}),i=(0,n.hb)(((e,t)=>{s((o=>({...o,[e]:t})))}),[]),a=(0,n.hb)((e=>!!o[e]),[o]),d=Object.values(o).some((e=>e));return(0,l.Y)(r.Provider,{value:{setLoading:i,isLoading:a,anyLoading:d},children:t})},i=e=>{const t=(0,n.NT)(r);if(!t)throw new Error("useLoading must be used within LoadingProvider");const{setLoading:o,isLoading:l}=t,s=(0,n.hb)((()=>o(e,!0)),[o,e]),i=(0,n.hb)((()=>o(e,!1)),[o,e]);return[l(e),s,i]}},35406:(e,t,o)=>{o.d(t,{N7:()=>M,fn:()=>g,lx:()=>T});var n=o(85908),l=o(69817),r=o(9055),s=o(16473),i=o(69573),a=o(98096),d=o(1681),c=o(51437),m=o.n(c),u=o(44440);const h=(0,n.q6)(),p=(0,n.q6)(),g=()=>{const e=(0,n.NT)(h);if(void 0===e)throw new Error("useModel must be used within a ModelProvider");return e},M=()=>{const e=(0,n.NT)(p);if(void 0===e)throw new Error("useModelFilter must be used within a ModelProvider");return e},T=e=>{let{children:t}=e;const{cacheEnabled:o}=(0,i.Y)(),{apiUrl:c}=(0,l.g)(),{idToken:g}=(0,s.A)(),{showToast:M}=(0,a.d)(),[T,f]=(0,n.J0)([]),[v,w]=(0,n.J0)({}),[k,b]=(0,n.J0)([]),[J,y]=(0,r.M)("selectedModel",null),[S,C]=(0,n.J0)(!0),[P,Y]=(0,n.J0)(null),[x,N]=(0,r.M)("showExperimental",!1),[E,F]=(0,n.J0)({search:"",categories:{Chat:!0,Image:!0,Embedding:!0}}),[,L,O]=(0,d.M3)("models");(0,n.vJ)((()=>{S?L():O()}),[S,L,O]);const I=(0,n.hb)((e=>e&&e.timestamp&&Date.now()-e.timestamp<432e6&&e.allModels&&e.processedModels&&e.experimentalModels),[]);(0,n.vJ)((()=>{if("undefined"!=typeof window)return window.isCacheValid=I,()=>{delete window.isCacheValid}}),[I]);const D=(0,n.hb)((e=>{try{const t={allModels:e.allModels,processedModels:e.processedModels,experimentalModels:e.experimentalModels,timestamp:Date.now()};localStorage.setItem("modelDropdownCache",JSON.stringify(t))}catch(P){}}),[]),q=(0,n.hb)(((e,t)=>{F((o=>({...o,categories:{...o.categories,[e]:t}})))}),[]),z=(0,n.hb)((e=>{F((t=>({...t,search:e})))}),[]),K=(0,n.hb)((e=>{(null==J?void 0:J.id)!==(null==e?void 0:e.id)&&y(e)}),[J,y]),R=(0,n.hb)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;C(!0),Y(null);try{const n={Accept:"application/json"};if(e){const e=t||g;e&&(n.Authorization=`Bearer ${e}`)}const l=new URL("/api/models/classified",c).toString(),r=await fetch(l,{headers:n});if(!r.ok){let e=`Error fetching models: ${r.status}`;throw new Error(e)}const s=await r.json(),i=new(m());i.onmessage=e=>{let{data:t}=e;if(t.error)Y(t.error),M({type:"error",message:t.error});else{const{allModels:e,processedModels:n,experimentalModels:l}=t;if(o){const t=localStorage.getItem("modelDropdownCache");let o;try{o=JSON.parse(t)}catch{o=null}(!o||JSON.stringify(o.allModels)!==JSON.stringify(e)||JSON.stringify(o.processedModels)!==JSON.stringify(n)||JSON.stringify(o.experimentalModels)!==JSON.stringify(l))&&(f(e),w(n),b(l),D({allModels:e,processedModels:n,experimentalModels:l}))}else f(e),w(n),b(l)}C(!1),i.terminate()},i.onerror=e=>{Y(e.message),M({type:"error",message:e.message}),C(!1),i.terminate()},i.postMessage(s)}catch(n){Y(n.message||"Failed to load model data"),M({type:"error",message:n.message||"Failed to load model data"})}}),[c,D,g,o,M]),V=(0,n.li)(!1),_=(0,n.li)(!1);(0,n.vJ)((()=>{if(!V.current){if(o){const e=localStorage.getItem("modelDropdownCache");let t;try{t=JSON.parse(e)}catch{t=null}t&&window.isCacheValid(t)&&(f(t.allModels),w(t.processedModels),b(t.experimentalModels),C(!1))}let e=null;try{e=localStorage.getItem("idToken")}catch{}e?(_.current=!0,R(!0,e)):R(!1),V.current=!0}}),[]),(0,n.vJ)((()=>{V.current&&g&&!_.current&&(_.current=!0,R(!0))}),[g,R]),(0,n.vJ)((()=>{!J&&T.length>0&&y(T[0])}),[T,J,y]);const j=(0,n.hb)((()=>{N((e=>!e))}),[N]),A=(0,n.Kr)((()=>({allModels:T,processedModels:v,experimentalModels:k,selectedModel:J,isLoading:S,error:P,showExperimental:x,isExperimentalModelsEnabled:x,toggleExperimentalModels:j,setShowExperimental:N,selectModel:K,refreshModels:R})),[T,v,k,J,S,P,x,j,N,K,R]),U=(0,n.Kr)((()=>({modelFilter:E,updateCategoryFilter:q,updateSearchFilter:z})),[E,q,z]);return(0,u.Y)(h.Provider,{value:A,children:(0,u.Y)(p.Provider,{value:U,children:t})})}},72378:(e,t,o)=>{o.d(t,{B:()=>i,b:()=>a});var n=o(85908),l=o(69643),r=o(44440);const s=(0,n.q6)(),i=()=>{const e=(0,n.NT)(s);if(void 0===e)throw new Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e},a=e=>{let{children:t}=e;const{setChatHistory:o}=(0,l.m)(),[i,a]=(0,n.J0)({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null}),d=(0,n.hb)((()=>{a({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null})}),[]),c=(0,n.hb)((()=>{a((e=>({...e,startTime:Date.now(),isComplete:!1})))}),[]),m=(0,n.hb)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;a((l=>{const r=Date.now(),s=l.startTime?r-l.startTime:0,i=e&&s?Math.round(e/(s/1e3)*10)/10:l.tokensPerSecond,a=l.timeToFirstToken||(e>0?s:null);return{startTime:l.startTime,endTime:r,elapsedTime:s,tokenCount:e,tokensPerSecond:i,isComplete:t,timeToFirstToken:a,promptTokens:(null==o?void 0:o.promptTokens)||l.promptTokens,completionTokens:(null==o?void 0:o.completionTokens)||l.completionTokens,totalTokens:(null==o?void 0:o.totalTokens)||l.totalTokens,finishReason:n||l.finishReason}}))}),[]);(0,n.vJ)((()=>{null!=i.endTime&&o((e=>{const t=[...e],o=t[t.length-1];return o&&"assistant"===o.role&&(o.metrics={...i}),t}))}),[i,o]);const u=(0,n.hb)((e=>{o((t=>{const o=[...t],n=o[o.length-1];return n&&"assistant"===n.role&&(n.metrics={...n.metrics||{},...e,isComplete:!0}),o}))}),[o]),h=(0,n.Kr)((()=>({currentMessageMetrics:i,resetPerformanceMetrics:d,startPerformanceTimer:c,updatePerformanceMetrics:m,setTokenMetricsForLastMessage:u})),[i,d,c,m,u]);return(0,r.Y)(s.Provider,{value:h,children:t})}},99928:(e,t,o)=>{o.d(t,{v:()=>M});var n=o(85908),l=o(96926),r=o(69817),s=o(35406),i=o(21344),a=o(66883),d=o(69643),c=o(72378),m=o(16594),u=o(33804),h=o(54860),p=o(44440);const g=(0,n.q6)(null),M=e=>{let{children:t}=e;const o=(0,n.Kr)((()=>({isInitialized:!1,setInitialized:e=>{o.isInitialized=e}})),[]);return(0,n.vJ)((()=>{o.setInitialized(!0)}),[o]),(0,p.Y)(g.Provider,{value:o,children:(0,p.Y)(l.N,{children:(0,p.Y)(r.K,{children:(0,p.Y)(s.lx,{children:(0,p.Y)(i.Z,{children:(0,p.Y)(a.g,{children:(0,p.Y)(d.U,{children:(0,p.Y)(c.b,{children:(0,p.Y)(m.V,{children:(0,p.Y)(u.h,{children:(0,p.Y)(h.n,{children:t})})})})})})})})})})})}}}]);
//# sourceMappingURL=app-large-8367718c.c1e4a6338c.v1_9_5.js.map