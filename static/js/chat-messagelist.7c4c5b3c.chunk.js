"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[9823],{12807:(e,s,t)=>{t.d(s,{rP:()=>a});const a=e=>{if("string"!=typeof e||""===e)return"";const s=new RegExp("(```[\\s\\S]*?```)|^(\\s*)\\\\\\[([\\s\\S]*?)\\\\\\](.*)|^(\\s*)\\[\\\\/([\\s\\S]*?)\\\\/](.*)|\\\\\\(\\s*(.*?)\\s*\\\\\\)","gm");let t=e.replace(s,((e,s,t,a,n,r,i,l,o)=>void 0!==s?s:void 0!==t?`${t}$$${a}$$`:void 0!==r?`${r}$$${i}$$`:void 0!==o?`$${o.trim()}$`:e));return t=t.replace(/\n{3,}/g,"\n\n"),t=t.replace(/\n{3,}/g,"\n\n"),t}},43548:(e,s,t)=>{t.r(s),t.d(s,{default:()=>f});var a=t(65043),n=t(66519),r=t(92503),i=t(94692),l=t(30591);function o(e){return e?e<1e3?`${e}ms`:`${(e/1e3).toFixed(1)}s`:"0.0s"}var c=t(12807),m=t(70579);const u=(0,a.lazy)((()=>Promise.all([t.e(4314),t.e(208),t.e(2179),t.e(3215),t.e(304),t.e(8457),t.e(7112),t.e(1569),t.e(1141),t.e(7187),t.e(5114),t.e(8398),t.e(648),t.e(8451),t.e(268),t.e(6060),t.e(610),t.e(6716),t.e(8990),t.e(3542),t.e(4644),t.e(8467),t.e(5419),t.e(9937),t.e(5174),t.e(6572),t.e(2360),t.e(5433),t.e(1327),t.e(3189),t.e(2500),t.e(5932),t.e(5444)]).then(t.bind(t,19224))));function d(e){let{children:s}=e;return(0,m.jsx)(a.Suspense,{fallback:(0,m.jsx)("div",{children:s}),children:(0,m.jsx)(u,{children:s})})}const g=(0,a.lazy)((()=>Promise.all([t.e(4314),t.e(208),t.e(2179),t.e(3215),t.e(304),t.e(8457),t.e(7112),t.e(1569),t.e(1141),t.e(7187),t.e(5114),t.e(8398),t.e(648),t.e(8451),t.e(2412),t.e(6017),t.e(399),t.e(4917),t.e(7777),t.e(7316),t.e(3294),t.e(268),t.e(6060),t.e(610),t.e(6716),t.e(8990),t.e(3542),t.e(4644),t.e(8467),t.e(4734),t.e(6755),t.e(4182),t.e(4582),t.e(8162),t.e(6760),t.e(1217),t.e(822),t.e(4335),t.e(6814),t.e(2489),t.e(9734),t.e(5522),t.e(5080),t.e(1927),t.e(9283),t.e(8476),t.e(5816),t.e(4120),t.e(7295),t.e(237),t.e(9104),t.e(2993),t.e(9889),t.e(392),t.e(7514),t.e(8482),t.e(5418),t.e(5174),t.e(6572),t.e(2360),t.e(5433),t.e(1327),t.e(3189),t.e(2500),t.e(5932),t.e(1506),t.e(9267),t.e(6604),t.e(9579)]).then(t.bind(t,74759))));let x;const p=e=>{let{message:s,isStreaming:n,onEditMessage:r,overrideContent:u}=e;const p=null!=u?u:s.content,[j,A]=(0,a.useState)(!1),h=(0,a.useMemo)((()=>"assistant"===s.role?p:(0,c.rP)(p)),[p,s.role]),[v,N]=(0,a.useState)(h);(0,a.useEffect)((()=>{if("assistant"!==s.role||"string"!=typeof p||"undefined"==typeof Worker)return;const e=s.timestamp,a=("undefined"==typeof Worker||x||(x=new Worker(new URL(t.p+t.u(2465),t.b),{type:void 0})),x),n=s=>{s.data.id===e&&(s.data.success?N(s.data.data):N(p))};return a.addEventListener("message",n),a.postMessage({id:e,content:p}),()=>{a.removeEventListener("message",n)}}),[p,s.role,s.timestamp]);const f=(0,a.useMemo)((()=>{switch(s.role){case"user":return(0,m.jsx)(i.nXn,{size:16,className:l.A.icon});case"assistant":return(0,m.jsx)(i.MiJ,{size:16,className:l.A.icon});case"system":return(0,m.jsx)(i.L64,{size:16,className:l.A.icon});case"error":return(0,m.jsx)(i._0O,{size:16,className:l.A.icon});default:return null}}),[s.role]),$=(0,a.useMemo)((()=>{switch(s.role){case"user":return l.A.userMessage;case"assistant":return l.A.assistantMessage;case"system":return l.A.systemMessage;case"error":return l.A.errorMessage;default:return""}}),[s.role]),y=(0,a.useMemo)((()=>!("assistant"!==s.role||!s.metrics)),[s.role,s.metrics]),k=(0,a.useCallback)((()=>{const e="string"==typeof s.content?s.content:Array.isArray(s.content)?s.content.filter((e=>"text"===e.type)).map((e=>e.text)).join("\n"):"";navigator.clipboard.writeText(e).then((()=>{A(!0),setTimeout((()=>A(!1)),2e3)}))}),[s.content]),C=(0,a.useMemo)((()=>(0,m.jsx)("button",{className:`${l.A.copyMessageButton} ${"assistant"===s.role&&y?l.A.copyButtonInMetrics:l.A.copyButtonBottomRight}`,onClick:k,"aria-label":"Copy message",title:"Copy message",children:j?(0,m.jsx)(i.Srz,{size:16}):(0,m.jsx)(i.TdU,{size:16})})),[k,s.role,y,j]),M=(0,a.useCallback)((()=>{r&&r(s)}),[r,s]),z=(0,a.useMemo)((()=>"user"===s.role?(0,m.jsx)("button",{className:l.A.editMessageButton,onClick:M,"aria-label":"Edit message",title:"Edit message",children:(0,m.jsx)(i.R2l,{size:16})}):null),[s.role,M]);return(0,m.jsxs)("div",{className:l.A.message+" "+$,children:[(0,m.jsx)("div",{className:l.A.avatar,children:f}),(0,m.jsxs)("div",{className:l.A.messageContentWrapper,children:[(0,m.jsx)(a.Suspense,{fallback:null,children:(0,m.jsx)("div",{className:l.A.messageContent,children:"assistant"===s.role?(0,m.jsx)(g,{content:v,isStreaming:n}):(0,m.jsx)(d,{children:v})})}),"assistant"===s.role&&(()=>{if(!y||!s.metrics)return null;const e=n,{elapsedTime:t,tokenCount:a,tokensPerSecond:r,timeToFirstToken:c,promptTokens:u,completionTokens:d,totalTokens:g,finishReason:x}=s.metrics;return null!=t||null!=a||null!=r||null!=c||null!=u||null!=d||null!=g||null!=x?(0,m.jsxs)("div",{className:l.A.metricsContainer,children:[null!=c&&0!==c&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.O4,{size:14,className:l.A.metricIcon}),"First Token: ",o(c)]}),null!=t&&0!==t&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.O4,{size:14,className:l.A.metricIcon}),"Total Time: ",o(t)]}),null!=a&&0!==a&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.MiJ,{size:14,className:l.A.metricIcon}),"Tokens: ",a]}),null!=u&&0!==u&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.MiJ,{size:14,className:l.A.metricIcon}),"Prompt: ",u]}),null!=d&&0!==d&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.MiJ,{size:14,className:l.A.metricIcon}),"Completion: ",d]}),null!=g&&0!==g&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.MiJ,{size:14,className:l.A.metricIcon}),"Total: ",g]}),null!=r&&0!==r&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i.BHx,{size:14,className:l.A.metricIcon}),"Speed: ",r," t/s"]}),null!=x&&""!==x&&(0,m.jsxs)("span",{className:l.A.metric,children:[(0,m.jsx)(i._0O,{size:14,className:l.A.metricIcon}),x]}),e&&(0,m.jsxs)("span",{className:`${l.A.metric} ${l.A.generatingIndicator}`,children:[(0,m.jsx)("span",{className:l.A.generatingDot}),"Generating..."]}),C]}):null})(),"user"!==s.role&&("assistant"!==s.role||!y)&&C]}),"user"===s.role&&(0,m.jsxs)("div",{className:l.A.userButtonContainer,children:[z,C]})]})},j=(0,a.memo)(p);var A=t(97950),h=t(20104);const v=e=>{let{src:s,onClose:t}=e;if(!s)return null;const a=(0,m.jsx)("div",{className:h.A.overlay,onClick:t,role:"dialog","aria-modal":"true",title:"Click to close image",children:(0,m.jsx)("img",{src:s,alt:"Full screen view",className:h.A.overlayImage,onClick:e=>{e.stopPropagation()}})});return A.createPortal(a,document.body)},N=(0,a.forwardRef)(((e,s)=>{let{messages:t,error:i,onEditMessage:l}=e;const{isWaitingForResponse:o}=(0,r.P)(),[c,u]=(0,a.useState)(null),d=(0,a.useMemo)((()=>{const e=[...t];return i&&e.push({role:"error",content:i,timestamp:Date.now()}),e}),[t,i]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:n.A.messageListContainer,ref:s,"aria-live":"polite","aria-relevant":"additions text",children:d.map(((e,s)=>{var t;const a=s===d.length-1,r="assistant"===e.role&&a&&o&&!(null!==(t=e.metrics)&&void 0!==t&&t.isComplete),{images:i,text:c}=function(e){if(!e)return{images:[],text:e};if(Array.isArray(e)){const{images:s,texts:t}=e.reduce(((e,s)=>("image_url"===s.type?e.images.push({url:s.image_url.url,alt:s.image_url.alt||s.alt||null}):"text"===s.type&&e.texts.push(s.text),e)),{images:[],texts:[]});return{images:s,text:t.join(" ")}}return{images:[],text:e}}(e.content),g=e.timestamp?`${e.role}-${e.timestamp}-${s}`:`${e.role}-${s}`;return(0,m.jsxs)("div",{className:n.A.messageRow,children:["user"===e.role&&i.length>0&&(0,m.jsx)("div",{className:n.A.imageContainer,children:i.map(((e,s)=>(0,m.jsx)("img",{src:e.url,alt:e.alt||`Uploaded image ${s+1}`,className:`${n.A.messageImage} ${n.A.clickableImage}`,onClick:()=>{return s=e.url,void u(s);var s}},`${g}-img-${s}`)))}),(c||"user"!==e.role)&&(0,m.jsx)(j,{message:e,overrideContent:c||void 0,isStreaming:r,onEditMessage:"user"===e.role?l:void 0})]},g)}))}),(0,m.jsx)(v,{src:c,onClose:()=>{u(null)}})]})}));N.displayName="MessageList";const f=(0,a.memo)(N)}}]);
//# sourceMappingURL=chat-messagelist.7c4c5b3c.chunk.js.map