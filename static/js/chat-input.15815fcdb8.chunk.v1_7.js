"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[7218],{93912:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var i=n(65043),l=n(63823),r=n(92503),s=n(92167),a=n(94692),o=n(43171),c=n(70579);const u=e=>{let{images:t,onRemoveImage:n}=e;return t&&0!==t.length?(0,c.jsx)("div",{className:o.A.imagePreviewContainer,children:t.map(((e,t)=>(0,c.jsxs)("div",{className:o.A.imagePreviewWrapper,children:[(0,c.jsx)("img",{src:e.url,alt:`preview ${t}`,className:o.A.imagePreview}),(0,c.jsx)("button",{className:o.A.removeImageButton,onClick:()=>n(t),"aria-label":`Remove image ${t+1}`,title:`Remove image ${t+1}`,children:(0,c.jsx)(a.uv5,{size:12})})]},t)))}):null},d=i.memo(u);var h=n(13547);const g=(0,i.forwardRef)(((e,t)=>{let{value:n,onChange:i,onKeyDown:l,onPaste:r,placeholder:s,disabled:o=!1,isEditing:u=!1,isWaitingForResponse:d=!1,selectedModel:g=null,onSendClick:m}=e;const p=d?"Stop generation":g?u?"Save edit":"Send message":"Select model",x=d?"Stop generation":g?u?"Save edit (Enter)":"Send message (Enter)":"Select a model";return(0,c.jsxs)("div",{className:`${h.A.ChatInput__inputWrapper} ${g?"":h.A.noModelSelected}`,children:[(0,c.jsx)("textarea",{ref:t,className:h.A.ChatInput__chatInput,placeholder:s,value:n,onChange:i,onKeyDown:l,onPaste:r,disabled:o,rows:1,"aria-label":"Chat message input"}),(0,c.jsx)("button",{className:`${h.A.ChatInput__sendButtonInline} ${d?h.A.ChatInput__stopButton:""} ${g?"":h.A.noModelSelected}`,onClick:m,disabled:!d&&(!(null!=n&&n.trim())||o),"aria-label":p,title:x,type:"button",children:d?(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"21",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,c.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}):g?u?(0,c.jsx)(a.Srz,{size:21}):(0,c.jsx)(a.GD3,{size:21}):(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})}));g.displayName="ChatInputTextArea";const m=g;var p=n(14489);const x=e=>{var t,n,i;let{isMobile:l=!1,isEditing:r=!1,disabled:s=!1,selectedModel:o=null,onNewChat:u,onUploadClick:d,onCancelEdit:h,onToggleModelSelector:g}=e;return(0,c.jsxs)("div",{className:p.A.ChatInput__actionRow,children:[(0,c.jsxs)("div",{className:p.A.ChatInput__leftButtons,children:[(0,c.jsx)("button",{className:p.A.ChatInput__uploadButton,onClick:d,disabled:s||!(null!=o&&null!==(t=o.capabilities)&&void 0!==t&&t.includes("vision")),"aria-label":null!=o&&null!==(n=o.capabilities)&&void 0!==n&&n.includes("vision")?"Upload images":"Select a model with vision capabilities",title:null!=o&&null!==(i=o.capabilities)&&void 0!==i&&i.includes("vision")?"Upload images":"Select a model with vision capabilities",type:"button",children:(0,c.jsx)(a.xfq,{size:16})}),(0,c.jsxs)("button",{className:`${p.A.ChatInput__textButton} ${l?p.A.ChatInput__iconOnlyButton:""}`,"aria-label":"Search",title:"Search (coming soon)",type:"button",disabled:!0,children:[(0,c.jsx)(a.WIv,{size:16}),!l&&(0,c.jsx)("span",{className:p.A.buttonText,children:"Search"})]}),(0,c.jsxs)("button",{className:`${p.A.ChatInput__textButton} ${l?p.A.ChatInput__iconOnlyButton:""}`,"aria-label":"Reason mode",title:"Reason mode (coming soon)",type:"button",disabled:!0,children:[(0,c.jsx)(a.XLj,{size:16}),!l&&(0,c.jsx)("span",{className:p.A.buttonText,children:"Reason"})]}),(0,c.jsx)("button",{className:p.A.ChatInput__actionButton,"aria-label":"More options",title:"More options (coming soon)",type:"button",disabled:!0,children:(0,c.jsx)(a.tno,{size:16})})]}),(0,c.jsxs)("div",{className:p.A.ChatInput__rightButtons,children:[(0,c.jsx)("button",{className:p.A.ChatInput__actionButton,onClick:u,"aria-label":"New chat",title:"New chat",type:"button",children:(0,c.jsx)(a.c11,{size:16})}),r&&(0,c.jsx)("button",{className:p.A.ChatInput__uploadButton,onClick:h,"aria-label":"Cancel edit",title:"Cancel edit (Esc)",type:"button",children:(0,c.jsx)(a.uv5,{size:16})}),(0,c.jsx)("button",{className:p.A.ChatInput__modelButton,onClick:g,"aria-label":"Select AI model",title:"Select AI model",type:"button",children:(0,c.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,c.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})]})},w=i.memo(x),v=e=>new Promise(((t,n)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=e=>n(e),i.readAsDataURL(e)})),f=(0,i.memo)((e=>{let{disabled:t=!1,selectedModel:n=null,isStaticLayout:a=!1,editingMessage:o=null,onCancelEdit:u=()=>{},isStreaming:h=!1,toggleModelSelector:g=()=>{},onFocus:p=()=>{},isInitialChat:x=!1,onSendMessage:f}=e;const[C,b]=(0,i.useState)(""),[y,j]=(0,i.useState)([]),_=(0,i.useRef)(null),A=(0,i.useRef)(null),k=!!o,[I,E]=(0,i.useState)(window.innerWidth<=600),{isWaitingForResponse:S}=(0,r.P)(),{stopGeneration:N,newChat:M}=(0,s.r)(),[B,$]=(0,i.useState)(null),L=(0,i.useRef)(null);(0,i.useEffect)((()=>{const e=()=>E(window.innerWidth<=600);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,i.useEffect)((()=>{var e;null===(e=_.current)||void 0===e||e.focus()}),[]),(0,i.useEffect)((()=>{if(o){let e="";const t=[];"string"==typeof o.content?e=o.content:Array.isArray(o.content)&&o.content.forEach((n=>{var i;"text"===n.type&&(e+=n.text||""),"image_url"===n.type&&null!==(i=n.image_url)&&void 0!==i&&i.url&&t.push({name:"",url:n.image_url.url})})),b(e),j(t),setTimeout((()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.focus()}),0)}else b(""),j([])}),[o]);const R=(0,i.useCallback)((()=>{const e=_.current;if(!e)return;e.style.height="auto";const t=Math.min(e.scrollHeight+2,200);e.style.height=`${t}px`;const n=e.closest(`.${l.A.ChatInput}`);n&&n.style.setProperty("--textarea-height",`${t}px`)}),[]);(0,i.useEffect)((()=>{R()}),[C,R]),(0,i.useEffect)((()=>{if(!I)return;const e=()=>{const e=window.innerHeight<.75*window.outerHeight;document.body.classList.toggle("keyboard-open",e)},t=()=>{I&&(document.body.classList.add("keyboard-open"),window.addEventListener("resize",e)),p&&p()},n=()=>{I&&(document.body.classList.remove("keyboard-open"),window.removeEventListener("resize",e))},i=_.current;return i&&(i.addEventListener("focus",t),i.addEventListener("blur",n)),()=>{i&&(i.removeEventListener("focus",t),i.removeEventListener("blur",n)),window.removeEventListener("resize",e),document.body.classList.remove("keyboard-open")}}),[I,p]);const z=(0,i.useCallback)((e=>{$(e),L.current&&clearTimeout(L.current),L.current=setTimeout((()=>{$(null),L.current=null}),3e3)}),[]);(0,i.useEffect)((()=>()=>{L.current&&clearTimeout(L.current)}),[]);const P=(0,i.useCallback)((e=>{b(e.target.value)}),[]),W=(0,i.useCallback)((()=>{const e=C.trim().length>0,i=y.length>0;if(!e&&!i||t)return;if(!n&&g)return void g();const l=[];e&&l.push({type:"text",text:C.trim()}),i&&y.forEach((e=>l.push({type:"image_url",image_url:{url:e.url}}))),l.length>0&&f(l,k?o:null),b(""),j([]),k&&u&&u(),_.current&&(_.current.style.height="auto",setTimeout((()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.focus()}),0))}),[C,y,t,n,g,f,k,o,u]),D=(0,i.useCallback)((e=>{"Enter"!==e.key||e.shiftKey?k&&"Escape"===e.key&&(e.preventDefault(),u&&u(),b(""),j([])):(e.preventDefault(),S||W())}),[S,W,k,u]),T=(0,i.useCallback)((async e=>{const t=Array.from(e.target.files);if(!t.length)return;if(y.length+t.length>5)return z("Max 5 images allowed."),void(A.current&&(A.current.value=""));try{const e=t.map((async e=>{if(!e.type.startsWith("image/"))throw new Error(`${e.name} invalid type.`);if(e.size>5242880)throw new Error(`${e.name} > 5MB.`);const t=await v(e);return{name:e.name,url:t}})),n=await Promise.all(e);j((e=>[...e,...n]))}catch(e){z(`Image error: ${e.message}`)}A.current&&(A.current.value="")}),[y.length,z]),F=(0,i.useCallback)((async e=>{var t;if(k)return;const n=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!n)return;const i=Array.from(n).filter((e=>e.type.startsWith("image/")));if(0===i.length)return;if(y.length+i.length>5)z("Max 5 images allowed.");else try{const t=i.map((async e=>{const t=e.getAsFile();if(t.size>5242880)throw new Error("Pasted image > 5MB.");const n=await v(t);return{name:"pasted-"+Date.now(),url:n}})),n=await Promise.all(t);n.length>0&&(j((e=>[...e,...n])),e.preventDefault())}catch(e){z(`Paste error: ${e.message}`)}}),[k,y.length,z]),U=(0,i.useCallback)((e=>{j((t=>t.filter(((t,n)=>n!==e))))}),[]),K=(0,i.useCallback)((()=>{var e;if(!n&&g)g();else if(null!=n&&null!==(e=n.capabilities)&&void 0!==e&&e.includes("vision")){var t;null===(t=A.current)||void 0===t||t.click()}else z("Select a model with vision capabilities to upload images.")}),[n,g,z]),H=(0,i.useCallback)((()=>{u&&u(),b(""),j([])}),[u]),G=(0,i.useCallback)((()=>{N()}),[N]),O=(0,i.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),S?G():W(),I&&_.current&&_.current.blur()}),[S,G,W,I]),q=k?"Edit your message...":S?"Type your next message while waiting...":"Ask anything";return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d,{images:y,onRemoveImage:U}),(0,c.jsxs)("div",{className:[l.A.ChatInput,k?l.A["ChatInput--editing"]:"",S?l.A["ChatInput--waitingForResponse"]:"",I?l.A.ChatInput__mobileView:"",I?x?l.A["ChatInput--mobileInitial"]:l.A["ChatInput--mobileWithMessages"]:""].filter(Boolean).join(" "),children:[B&&(0,c.jsx)("div",{className:l.A.ChatInput__error,role:"alert",children:B}),(0,c.jsx)("input",{type:"file",ref:A,style:{display:"none"},accept:"image/jpeg, image/png, image/gif, image/webp",multiple:!0,onChange:T}),(0,c.jsx)(m,{ref:_,value:C,onChange:P,onKeyDown:D,onPaste:F,placeholder:q,disabled:t,isEditing:k,isWaitingForResponse:S,selectedModel:n,onSendClick:O}),(0,c.jsx)(w,{isMobile:I,isEditing:k,disabled:t,selectedModel:n,onNewChat:M,onUploadClick:K,onCancelEdit:H,onToggleModelSelector:g})]})]})}));f.displayName="ChatInput";const C=f}}]);
//# sourceMappingURL=chat-input.15815fcdb8.chunk.v1_7.js.map