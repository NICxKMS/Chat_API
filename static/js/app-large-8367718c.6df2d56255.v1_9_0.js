"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([["app-large-8367718c"],{1681:(e,t,r)=>{r.d(t,{M3:()=>l,oo:()=>i});var n=r(85908),o=r(44440);const s=(0,n.q6)(null),i=e=>{let{children:t}=e;const[r,i]=(0,n.J0)({}),l=(0,n.hb)(((e,t)=>{i((r=>({...r,[e]:t})))}),[]),a=(0,n.hb)((e=>!!r[e]),[r]),d=Object.values(r).some((e=>e));return(0,o.Y)(s.Provider,{value:{setLoading:l,isLoading:a,anyLoading:d},children:t})},l=e=>{const t=(0,n.NT)(s);if(!t)throw new Error("useLoading must be used within LoadingProvider");const{setLoading:r,isLoading:o}=t,i=(0,n.hb)((()=>r(e,!0)),[r,e]),l=(0,n.hb)((()=>r(e,!1)),[r,e]);return[o(e),i,l]}},16594:(e,t,r)=>{r.d(t,{$:()=>w,V:()=>y});var n=r(85908),o=r(69817),s=r(35406),i=r(21344),l=r(16473),a=r(69643),d=r(66883),c=r(72378),u=r(93827),m=r(26331),h=r.n(m),p=r(96824),g=r.n(p),v=r(44440);const f=(0,n.q6)(),w=()=>{const e=(0,n.NT)(f);if(void 0===e)throw new Error("useStreamingEvents must be used within a StreamingEventsProvider");return e},y=e=>{let{children:t}=e;const{apiUrl:r}=(0,o.g)(),{selectedModel:m}=(0,s.fn)(),{getModelAdjustedSettings:p}=(0,i.t)(),{idToken:w}=(0,l.A)(),{chatHistoryRef:y,setChatHistory:T,addMessageToHistory:b,updateChatWithContent:M}=(0,a.m)(),{setIsWaitingForResponse:k,setError:S}=(0,d.A)(),{resetPerformanceMetrics:C,startPerformanceTimer:P,updatePerformanceMetrics:x}=(0,c.B)(),J=(0,n.li)(""),E=(0,n.li)(null),N=(0,n.li)(null),I=(0,n.li)(!1),Y=(0,n.li)(!1),A=(0,n.Kr)((()=>h()((e=>M(e)),20)),[M]),_=((0,n.li)(null),(0,n.li)(null)),D=(0,n.hb)((()=>(_.current||(_.current=new(g())),_.current)),[]),O=(0,n.hb)((e=>new Promise(((t,r)=>{const n=D();n.onmessage=e=>t(e.data),n.onerror=r,n.postMessage(e)}))),[D]),q=(0,n.hb)((async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2)+Date.now().toString(36);E.current=n;const o=null!==t&&Number.isInteger(t)&&t>=0;if(!e||!m)return S("Please enter a message and select a model"),null;const s=`${m.provider}/${m.id}`;if(!s)return S("Invalid model selection"),null;let i;o?T((r=>{const n=r.slice(0,t),o=r[t];return i={...o,content:e},[...n,i]})):i=b("user",e),C(),P(),Y.current=!1,k(!0),S(null),J.current="",I.current=!0,b("assistant","");let l=setTimeout((()=>{var e;null===(e=N.current)||void 0===e||e.abort("timeout"),S("Connection timed out"),k(!1)}),6e4);const a=new AbortController;N.current=a;try{const e=p(m),t=y.current.slice(0,-1).map((e=>{let{metrics:t,...r}=e;return r}));!e.systemPrompt||t.length&&"system"===t[0].role||t.unshift({role:"system",content:e.systemPrompt,timestamp:Date.now()-1});const o={requestId:n,model:s,messages:t,temperature:e.temperature,max_tokens:e.max_tokens,top_p:e.top_p,frequency_penalty:e.frequency_penalty,presence_penalty:e.presence_penalty},i={"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"};w&&(i.Authorization=`Bearer ${w}`);const f=await(0,u.J)(new URL("/api/chat/stream",r).toString(),{method:"POST",headers:i,body:JSON.stringify(o),signal:a.signal,cache:"no-store"});if(!f.ok)throw new Error(`API error: ${f.status}`);const b=f.body.getReader(),C=new TextDecoder("utf-8");let P="";for(;;){const{done:e,value:t}=await b.read();if(clearTimeout(l),l=setTimeout((()=>{var e;null===(e=N.current)||void 0===e||e.abort(),S("Connection timed out"),k(!1)}),6e4),e)break;const r=C.decode(t,{stream:!0});try{const e=await O(r);for(const t of e){var d,c,h;if(null!==(d=t.rawChunk)&&void 0!==d&&d.error||"error"===t.finishReason){var g,v;const e=(null===(g=t.rawChunk)||void 0===g||null===(v=g.error)||void 0===v?void 0:v.message)||"Error occurred during generation";return S(e),T((t=>{const r=[...t],n=r[r.length-1];return n&&"assistant"===n.role&&(n.content+=`\n\n**Error:** ${e}`,n.metrics&&(n.metrics.isComplete=!0,n.metrics.error=!0)),r})),null}t.content&&(Y.current||(x(1),Y.current=!0),P+=t.content,J.current=P,A(P));const e=null!==(c=null===(h=t.usage)||void 0===h?void 0:h.completionTokens)&&void 0!==c?c:0;x(e,t.isDone,t.usage,t.finishReason)}}catch{}}return A.flush(),M(J.current),J.current}catch(f){return S(f.message),T((e=>{const t=[...e],r=t[t.length-1];return r&&"assistant"===r.role&&(r.content+=`\n\n**Error:** ${f.message||"Error occurred during generation"}`,r.metrics&&(r.metrics.isComplete=!0,r.metrics.error=!0)),t})),null}finally{clearTimeout(l),I.current=!1,k(!1),E.current=null}}),[r,m,p,w,y,T,b,M,A,S,k,C,P,x,O]),F=(0,n.hb)((async()=>{N.current&&N.current.abort("user_stopped");const e=E.current;if(e){const t={"Content-Type":"application/json"};w&&(t.Authorization=`Bearer ${w}`);try{await(0,u.J)(new URL("/api/chat/stop",r).toString(),{method:"POST",headers:t,body:JSON.stringify({requestId:e})})}catch{}finally{E.current=null,N.current=null}}return I.current=!1,k(!1),!0}),[r,w,k]),L=(0,n.Kr)((()=>({streamMessageWithFetch:q,stopStreaming:F,parseStreamChunk:O,streamingTextRef:J,isStreaming:()=>I.current})),[q,F,O]);return(0,v.Y)(f.Provider,{value:L,children:t})}},21344:(e,t,r)=>{r.d(t,{Z:()=>d,t:()=>a});var n=r(85908),o=r(9055),s=r(44440);const i={temperature:.7,top_p:1,max_tokens:8191,frequency_penalty:0,presence_penalty:0,streaming:!0,systemPrompt:'You are a knowledgeable, friendly, and supportive university-level assistant.\n\nFor every question or topic, provide a clear, engaging, and well-structured answer, styled like an expert mentor or senior student.\n\nStyle and Structure:\n\nBegin with a welcoming, positive intro (e.g., "Alright! I\'ll break this down for you in detail section by section, with clear explanations and important points.").\nOrganize your response into numbered sections, each with a descriptive header and an emoji (e.g., # ğŸ“š 1. Core Concept).\nIn each section, explain:\nCore ideas and definitions\nHow things work (step-by-step, or process overview)\nAny relevant formulas, code, or examples\nKey points, tips, or comparisons\nUse subheadings, bullet points, tables, and diagrams (ASCII or LaTeX) for clarity when helpful.\nAt the end, summarize with a "Key Takeaways" or "Next Steps/Related Topics" section, with quick revision notes, further reading, or suggestions for deeper exploration if relevant.\nAlways offer to provide summary tables, code snippets, or quick revision notes if the user wants them.\nTone: Friendly, supportive, and approachableâ€”like a helpful peer or mentor. Formatting: Use bold, italics, emojis, markdown headers, and tables to maximize clarity.\n\nUse emojis befitting the context\n\nYour goal: Make complex ideas easy to understand, memorable, and actionable for the studentâ€”whether for study, projects, or curiosity.'},l=(0,n.q6)(),a=()=>{const e=(0,n.NT)(l);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},d=e=>{let{children:t}=e;const[r,a]=(0,o.M)("appSettings",i),d=(0,n.hb)(((e,t)=>{e in i&&a((r=>({...r,[e]:t})))}),[a]),c=(0,n.hb)((()=>{a(i)}),[a]),u=(0,n.hb)((e=>!!e&&(!0===e.requiresFixedTemperature||e.properties&&e.properties.includes("fixed_temperature")||e.id&&e.id.toLowerCase().startsWith("o")||e.series&&"o-series"===e.series.toLowerCase())),[]),m=(0,n.hb)((e=>u(e)?{...r,temperature:1}:r),[r,u]),h=(0,n.Kr)((()=>({settings:r,updateSetting:d,resetSettings:c,shouldRestrictTemperature:u,getModelAdjustedSettings:m})),[r,d,c,u,m]);return(0,s.Y)(l.Provider,{value:h,children:t})}},35406:(e,t,r)=>{r.d(t,{N7:()=>v,fn:()=>g,lx:()=>f});var n=r(85908),o=r(69817),s=r(9055),i=r(16473),l=r(69573),a=r(98096),d=r(1681),c=r(51437),u=r.n(c),m=r(44440);const h=(0,n.q6)(),p=(0,n.q6)(),g=()=>{const e=(0,n.NT)(h);if(void 0===e)throw new Error("useModel must be used within a ModelProvider");return e},v=()=>{const e=(0,n.NT)(p);if(void 0===e)throw new Error("useModelFilter must be used within a ModelProvider");return e},f=e=>{let{children:t}=e;const{cacheEnabled:r}=(0,l.Y)(),{apiUrl:c}=(0,o.g)(),{idToken:g}=(0,i.A)(),{showToast:v}=(0,a.d)(),[f,w]=(0,n.J0)([]),[y,T]=(0,n.J0)({}),[b,M]=(0,n.J0)([]),[k,S]=(0,s.M)("selectedModel",null),[C,P]=(0,n.J0)(!0),[x,J]=(0,n.J0)(null),[E,N]=(0,s.M)("showExperimental",!1),[I,Y]=(0,n.J0)({search:"",categories:{Chat:!0,Image:!0,Embedding:!0}}),[,A,_]=(0,d.M3)("models");(0,n.vJ)((()=>{C?A():_()}),[C,A,_]);const D=(0,n.hb)((e=>e&&e.timestamp&&Date.now()-e.timestamp<432e6&&e.allModels&&e.processedModels&&e.experimentalModels),[]);(0,n.vJ)((()=>{if("undefined"!=typeof window)return window.isCacheValid=D,()=>{delete window.isCacheValid}}),[D]);const O=(0,n.hb)((e=>{try{const t={allModels:e.allModels,processedModels:e.processedModels,experimentalModels:e.experimentalModels,timestamp:Date.now()};localStorage.setItem("modelDropdownCache",JSON.stringify(t))}catch(x){}}),[]),q=(0,n.hb)(((e,t)=>{Y((r=>({...r,categories:{...r.categories,[e]:t}})))}),[]),F=(0,n.hb)((e=>{Y((t=>({...t,search:e})))}),[]),L=(0,n.hb)((e=>{(null==k?void 0:k.id)!==(null==e?void 0:e.id)&&S(e)}),[k,S]),R=(0,n.hb)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;P(!0),J(null);try{const n={Accept:"application/json"};if(e){const e=t||g;e&&(n.Authorization=`Bearer ${e}`)}const o=new URL("/api/models/classified",c).toString(),s=await fetch(o,{headers:n});if(!s.ok){let e=`Error fetching models: ${s.status}`;throw new Error(e)}const i=await s.json(),l=new(u());l.onmessage=e=>{let{data:t}=e;if(t.error)J(t.error),v({type:"error",message:t.error});else{const{allModels:e,processedModels:n,experimentalModels:o}=t;if(r){const t=localStorage.getItem("modelDropdownCache");let r;try{r=JSON.parse(t)}catch{r=null}(!r||JSON.stringify(r.allModels)!==JSON.stringify(e)||JSON.stringify(r.processedModels)!==JSON.stringify(n)||JSON.stringify(r.experimentalModels)!==JSON.stringify(o))&&(w(e),T(n),M(o),O({allModels:e,processedModels:n,experimentalModels:o}))}else w(e),T(n),M(o)}P(!1),l.terminate()},l.onerror=e=>{J(e.message),v({type:"error",message:e.message}),P(!1),l.terminate()},l.postMessage(i)}catch(n){J(n.message||"Failed to load model data"),v({type:"error",message:n.message||"Failed to load model data"})}}),[c,O,g,r,v]),U=(0,n.li)(!1),j=(0,n.li)(!1);(0,n.vJ)((()=>{if(!U.current){if(r){const e=localStorage.getItem("modelDropdownCache");let t;try{t=JSON.parse(e)}catch{t=null}t&&window.isCacheValid(t)&&(w(t.allModels),T(t.processedModels),M(t.experimentalModels),P(!1))}let e=null;try{e=localStorage.getItem("idToken")}catch{}e?(j.current=!0,R(!0,e)):R(!1),U.current=!0}}),[]),(0,n.vJ)((()=>{U.current&&g&&!j.current&&(j.current=!0,R(!0))}),[g,R]),(0,n.vJ)((()=>{!k&&f.length>0&&S(f[0])}),[f,k,S]);const K=(0,n.hb)((()=>{N((e=>!e))}),[N]),$=(0,n.Kr)((()=>({allModels:f,processedModels:y,experimentalModels:b,selectedModel:k,isLoading:C,error:x,showExperimental:E,isExperimentalModelsEnabled:E,toggleExperimentalModels:K,setShowExperimental:N,selectModel:L,refreshModels:R})),[f,y,b,k,C,x,E,K,N,L,R]),z=(0,n.Kr)((()=>({modelFilter:I,updateCategoryFilter:q,updateSearchFilter:F})),[I,q,F]);return(0,m.Y)(h.Provider,{value:$,children:(0,m.Y)(p.Provider,{value:z,children:t})})}},72378:(e,t,r)=>{r.d(t,{B:()=>l,b:()=>a});var n=r(85908),o=r(69643),s=r(44440);const i=(0,n.q6)(),l=()=>{const e=(0,n.NT)(i);if(void 0===e)throw new Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e},a=e=>{let{children:t}=e;const{setChatHistory:r}=(0,o.m)(),[l,a]=(0,n.J0)({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null}),d=(0,n.hb)((()=>{a({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null})}),[]),c=(0,n.hb)((()=>{a((e=>({...e,startTime:Date.now(),isComplete:!1})))}),[]),u=(0,n.hb)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;a((o=>{const s=Date.now(),i=o.startTime?s-o.startTime:0,l=e&&i?Math.round(e/(i/1e3)*10)/10:o.tokensPerSecond,a=o.timeToFirstToken||(e>0?i:null);return{startTime:o.startTime,endTime:s,elapsedTime:i,tokenCount:e,tokensPerSecond:l,isComplete:t,timeToFirstToken:a,promptTokens:(null==r?void 0:r.promptTokens)||o.promptTokens,completionTokens:(null==r?void 0:r.completionTokens)||o.completionTokens,totalTokens:(null==r?void 0:r.totalTokens)||o.totalTokens,finishReason:n||o.finishReason}}))}),[]);(0,n.vJ)((()=>{null!=l.endTime&&r((e=>{const t=[...e],r=t[t.length-1];return r&&"assistant"===r.role&&(r.metrics={...l}),t}))}),[l,r]);const m=(0,n.hb)((e=>{r((t=>{const r=[...t],n=r[r.length-1];return n&&"assistant"===n.role&&(n.metrics={...n.metrics||{},...e,isComplete:!0}),r}))}),[r]),h=(0,n.Kr)((()=>({currentMessageMetrics:l,resetPerformanceMetrics:d,startPerformanceTimer:c,updatePerformanceMetrics:u,setTokenMetricsForLastMessage:m})),[l,d,c,u,m]);return(0,s.Y)(i.Provider,{value:h,children:t})}},96926:(e,t,r)=>{r.d(t,{D:()=>i,N:()=>l});var n=r(85908),o=r(44440);const s=(0,n.q6)(),i=()=>{const e=(0,n.NT)(s);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e},l=e=>{let{children:t}=e;const[r,i]=(0,n.J0)((()=>localStorage.getItem("theme")||"dark")),l=(0,n.hb)((()=>{i((e=>{const t="dark"===e?"light":"dark";return localStorage.setItem("theme",t),t}))}),[]);(0,n.vJ)((()=>{document.body.classList.remove("light-mode","dark-mode"),document.body.classList.add(`${r}-mode`)}),[r]);const a=(0,n.Kr)((()=>({theme:r,toggleTheme:l,isDark:"dark"===r})),[r,l]);return(0,o.Y)(s.Provider,{value:a,children:t})}},98096:(e,t,r)=>{r.d(t,{d:()=>l,t:()=>u});var n=r(85908),o=r(20163),s=r(44440);const i=(0,n.q6)(),l=()=>{const e=(0,n.NT)(i);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},a="ADD_TOAST",d="REMOVE_TOAST";function c(e,t){switch(t.type){case a:return[...e,t.payload];case d:return e.filter((e=>e.id!==t.payload));default:return e}}const u=e=>{let{children:t}=e;const[r,l]=(0,n.WO)(c,[]),u=(0,n.hb)((e=>{let{type:t,message:r,duration:n=3e3}=e;const o=Date.now().toString()+Math.random().toString(36).substr(2,9);return l({type:a,payload:{id:o,type:t,message:r,duration:n}}),setTimeout((()=>l({type:d,payload:o})),n),o}),[]),m=(0,n.hb)((e=>{l({type:d,payload:e})}),[]);return(0,s.FD)(i.Provider,{value:{showToast:u,dismissToast:m},children:[t,(0,s.Y)(o.A,{toasts:r,dismissToast:m})]})}},99928:(e,t,r)=>{r.d(t,{v:()=>v});var n=r(85908),o=r(96926),s=r(69817),i=r(35406),l=r(21344),a=r(66883),d=r(69643),c=r(72378),u=r(16594),m=r(33804),h=r(54860),p=r(44440);const g=(0,n.q6)(null),v=e=>{let{children:t}=e;const r=(0,n.Kr)((()=>({isInitialized:!1,setInitialized:e=>{r.isInitialized=e}})),[]);return(0,n.vJ)((()=>{r.setInitialized(!0)}),[r]),(0,p.Y)(g.Provider,{value:r,children:(0,p.Y)(o.N,{children:(0,p.Y)(s.K,{children:(0,p.Y)(i.lx,{children:(0,p.Y)(l.Z,{children:(0,p.Y)(a.g,{children:(0,p.Y)(d.U,{children:(0,p.Y)(c.b,{children:(0,p.Y)(u.V,{children:(0,p.Y)(m.h,{children:(0,p.Y)(h.n,{children:t})})})})})})})})})})})}}}]);
//# sourceMappingURL=app-large-8367718c.6df2d56255.v1_9_0.js.map