(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[8403],{4807:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var r=n(65043),a=n(92503),i=n(92167),s=n(96377),o=n(20409);const l=()=>{const{chatHistory:e,isWaitingForResponse:t,error:n,currentMessageMetrics:l}=(0,a.P)(),{sendMessage:c,clearChat:u,downloadChatHistory:d}=(0,i.r)(),{selectedModel:f}=(0,s.fn)(),{settings:h}=(0,o.t)(),m=(0,r.useCallback)((async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=!!n;if(((Array.isArray(t)?t.map((e=>"text"===e.type?e.text:"")).join(" ").trim():t)||Array.isArray(t))&&f)try{if(r){const r=n.uniqueId||n.id||n.timestamp,a=e.findIndex((e=>[e.uniqueId,e.id,e.timestamp].includes(r)||"string"==typeof e.content&&e.content===n.content&&"user"===e.role));if(-1===a)return void 0;const i=Array.isArray(t)?t:{type:"text",text:t};Array.isArray(i),i.uniqueId=r,await c(i,a)}else{const e=`msg_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,n=Array.isArray(t)?t.map((t=>({...t,uniqueId:e}))):t;Array.isArray(n)||(n.uniqueId=e),await c(n)}}catch(e){}}),[f,c,e]);return{chatHistory:e,isWaitingForResponse:t,error:n,metrics:l,selectedModel:f,settings:h,handleSendMessage:m,resetChat:u,downloadChatHistory:d}};var c=n(94692),u=n(60247),d=n(70381),f=n.n(d),h=n(70579);const m=(0,r.lazy)((()=>Promise.all([n.e(3011),n.e(5087),n.e(8810),n.e(2845),n.e(9793),n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(438),n.e(662),n.e(7272),n.e(7390),n.e(9823)]).then(n.bind(n,43548)))),p=(0,r.lazy)((()=>Promise.all([n.e(3011),n.e(5087),n.e(8810),n.e(2845),n.e(9793),n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(438),n.e(662),n.e(7272),n.e(7390),n.e(7218)]).then(n.bind(n,93912)))),C=(0,r.lazy)((()=>Promise.all([n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(438),n.e(662),n.e(7272),n.e(7390),n.e(1770)]).then(n.bind(n,92932)))),g=(0,r.lazy)((()=>Promise.all([n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(438),n.e(662),n.e(7272),n.e(7390),n.e(6385)]).then(n.bind(n,84275)))),v=(0,r.memo)((e=>{let{selectedModel:t,isLoadingModels:n,toggleModelSelector:a,onToggleSettings:i,isSidebarOpen:s,isSettingsOpen:o,isModelSelectorOpen:d}=e;const{chatHistory:v,isWaitingForResponse:y,error:b,metrics:x,selectedModel:A,handleSendMessage:j}=l(),[_,S]=(0,r.useState)(null),M=(0,r.useRef)(null),N=(0,r.useRef)(null),k=v.length>0,[T,E]=(0,r.useState)(!1),I=(0,r.useRef)(y),[$,w]=(0,r.useState)(!0),H=(0,r.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";N.current&&(N.current.scrollTo({top:N.current.scrollHeight,behavior:e}),E(!1))}),[]),O=(0,r.useCallback)((()=>{const e=N.current;if(!e)return;const t=e.scrollHeight-e.scrollTop-e.clientHeight<10;E(!t),w(t)}),[]),W=(0,r.useMemo)((()=>f()(O,100)),[O]),q=(0,r.useCallback)((()=>{setTimeout((()=>{const e=document.querySelector("textarea."+u.A.chatInput)||document.querySelector('textarea[aria-label="Chat message input"]');e&&e.focus()}),100)}),[]);(0,r.useEffect)((()=>{q()}),[q]),(0,r.useEffect)((()=>{if(I.current&&!y){!(s||o||d||_)&&q()}I.current=y}),[y,s,o,d,_,q]),(0,r.useEffect)((()=>{const e=N.current;if(e)return W(),e.addEventListener("scroll",W,{passive:!0}),()=>{e.removeEventListener("scroll",W),W.cancel()}}),[W]),(0,r.useEffect)((()=>{const e=N.current;if(!e)return;const t=()=>{const t=e.scrollHeight-e.scrollTop-e.clientHeight<10;E(!t),w(t)};return t(),e.addEventListener("scroll",t,{passive:!0}),()=>e.removeEventListener("scroll",t)}),[T]),(0,r.useEffect)((()=>{const e=setTimeout((()=>W()),100);return()=>clearTimeout(e)}),[v,W]);const P=null==t?void 0:t.name,F=null==t?void 0:t.provider,R=(0,r.useCallback)((e=>{y||(S(e),setTimeout((()=>{const e=document.querySelector(`.${u.A.fixedInputArea}`);e&&e.scrollIntoView({behavior:"smooth"})}),100))}),[y]),z=(0,r.useCallback)((()=>{S(null)}),[]);(0,r.useEffect)((()=>{y&&_&&S(null)}),[y,_]);const L=`${u.A.ChatContainer} ${k?u.A["ChatContainer--activeChat"]:u.A["ChatContainer--emptyChat"]} ${_?u.A["ChatContainer--editingMode"]:""}`,B=e=>(0,h.jsxs)(h.Fragment,{children:[e&&!_&&(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)("div",{className:u.A.globalMetricsPlaceholder}),children:(0,h.jsx)(C,{metrics:null==x?void 0:x.session,modelName:null==A?void 0:A.name})}),(0,h.jsx)("div",{className:u.A.ChatContainer__inputControlsWrapper,children:(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)("div",{className:u.A.ChatContainer__inputPlaceholder}),children:(0,h.jsx)(p,{onSendMessage:j,disabled:y,selectedModel:A,editingMessage:_,onCancelEdit:z,isStreaming:y,toggleModelSelector:a,onFocus:q,isAtBottom:$})})})]});return(0,h.jsxs)("div",{className:L,children:[(0,h.jsx)("div",{className:u.A.ChatContainer__modelButtonContainer,children:(0,h.jsx)(r.Suspense,{fallback:null,children:(0,h.jsx)(g,{selectedModelName:P,providerName:F,onClick:a,disabled:n})})}),(0,h.jsxs)("div",{className:u.A.ChatContainer__chatAreaWrapper,children:[(0,h.jsx)("div",{className:u.A.ChatContainer__chatArea,children:k?(0,h.jsx)("div",{className:u.A.ChatContainer__scrollContainer,ref:N,children:(0,h.jsx)("div",{className:u.A.ChatContainer__scrollInner,children:(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)("div",{className:u.A.messagePlaceholder}),children:(0,h.jsx)(m,{ref:M,messages:v,error:b,onEditMessage:R})})})}):(0,h.jsxs)("div",{className:u.A.ChatContainer__emptyChatContent,children:[(0,h.jsxs)("div",{className:u.A.ChatContainer__greetingMessage,children:[(0,h.jsx)("h2",{children:"Welcome to AI Chat!"}),(0,h.jsx)("p",{children:"Select a model above and start your conversation."})]}),(0,h.jsx)("div",{className:`${u.A.ChatContainer__inputArea} ${u.A.ChatContainer__staticInputArea}`,children:B(!1)})]})}),T&&k&&(0,h.jsx)("button",{className:u.A.ChatContainer__scrollToBottomButton,onClick:()=>H("smooth"),"aria-label":"Scroll to bottom",title:"Scroll to bottom",children:(0,h.jsx)(c.D3D,{size:20})})]}),k&&(0,h.jsx)("div",{className:`${u.A.ChatContainer__inputArea} ${u.A.ChatContainer__fixedInputArea}`,children:B(!0)})]})}));v.displayName="ChatContainer";const y=v},70381:(e,t,n)=>{var r="Expected a function",a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=c||u||Function("return this")(),f=Object.prototype.toString,h=Math.max,m=Math.min,p=function(){return d.Date.now()};function C(e,t,n){var a,i,s,o,l,c,u=0,d=!1,f=!1,C=!0;if("function"!=typeof e)throw new TypeError(r);function y(t){var n=a,r=i;return a=i=void 0,u=t,o=e.apply(r,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=s}function x(){var e=p();if(b(e))return A(e);l=setTimeout(x,function(e){var n=t-(e-c);return f?m(n,s-(e-u)):n}(e))}function A(e){return l=void 0,C&&a?y(e):(a=i=void 0,o)}function j(){var e=p(),n=b(e);if(a=arguments,i=this,c=e,n){if(void 0===l)return function(e){return u=e,l=setTimeout(x,t),d?y(e):o}(c);if(f)return l=setTimeout(x,t),y(c)}return void 0===l&&(l=setTimeout(x,t)),o}return t=v(t)||0,g(n)&&(d=!!n.leading,s=(f="maxWait"in n)?h(v(n.maxWait)||0,t):s,C="trailing"in n?!!n.trailing:C),j.cancel=function(){void 0!==l&&clearTimeout(l),u=0,a=c=i=l=void 0},j.flush=function(){return void 0===l?o:A(p())},j}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=s.test(e);return n||o.test(e)?l(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var a=!0,i=!0;if("function"!=typeof e)throw new TypeError(r);return g(n)&&(a="leading"in n?!!n.leading:a,i="trailing"in n?!!n.trailing:i),C(e,t,{leading:a,maxWait:t,trailing:i})}}}]);
//# sourceMappingURL=chat-container.a137e951.chunk.js.map