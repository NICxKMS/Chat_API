(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[8403],{4807:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>A});var r=n(65043),s=n(92503),i=n(92167),o=n(96377),a=n(20409);const l=()=>{const{chatHistory:e,isWaitingForResponse:t,error:n,currentMessageMetrics:l}=(0,s.P)(),{sendMessage:c,clearChat:u,downloadChatHistory:d}=(0,i.r)(),{selectedModel:f}=(0,o.fn)(),{settings:m}=(0,a.t)(),h=(0,r.useCallback)((async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=!!n;if(((Array.isArray(t)?t.map((e=>"text"===e.type?e.text:"")).join(" ").trim():t)||Array.isArray(t))&&f)try{if(r){const r=n.uniqueId||n.id||n.timestamp,s=e.findIndex((e=>[e.uniqueId,e.id,e.timestamp].includes(r)||"string"==typeof e.content&&e.content===n.content&&"user"===e.role));if(-1===s)return void 0;const i=Array.isArray(t)?t:{type:"text",text:t};Array.isArray(i),i.uniqueId=r,await c(i,s)}else{const e=`msg_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,n=Array.isArray(t)?t.map((t=>({...t,uniqueId:e}))):t;Array.isArray(n)||(n.uniqueId=e),await c(n)}}catch(e){}}),[f,c,e]);return{chatHistory:e,isWaitingForResponse:t,error:n,metrics:l,selectedModel:f,settings:m,handleSendMessage:h,resetChat:u,downloadChatHistory:d}};var c=n(94692),u=n(60247),d=n(70381),f=n.n(d),m=n(70579);const h=(0,r.lazy)((()=>Promise.all([n.e(3011),n.e(5087),n.e(8810),n.e(2845),n.e(9793),n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(7316),n.e(3294),n.e(9823)]).then(n.bind(n,43548)))),p=(0,r.lazy)((()=>Promise.all([n.e(3011),n.e(5087),n.e(8810),n.e(2845),n.e(9793),n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(7316),n.e(3294),n.e(7218)]).then(n.bind(n,19217)))),g=(0,r.lazy)((()=>Promise.all([n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(7316),n.e(3294),n.e(1770)]).then(n.bind(n,92932)))),v=(0,r.lazy)((()=>Promise.all([n.e(6017),n.e(399),n.e(4917),n.e(7777),n.e(7316),n.e(3294),n.e(6385)]).then(n.bind(n,84275)))),y=(0,r.memo)((e=>{let{selectedModel:t,isLoadingModels:n,toggleModelSelector:s,onNewChat:i,onResetChat:o,onDownloadChat:a,onToggleSettings:d,isSidebarOpen:y,isSettingsOpen:A,isModelSelectorOpen:b}=e;const{chatHistory:x,isWaitingForResponse:j,error:C,metrics:S,selectedModel:M,handleSendMessage:N}=l(),[k,w]=(0,r.useState)(null),T=(0,r.useRef)(null),$=(0,r.useRef)(null),E=x.length>0,[I,q]=(0,r.useState)(!1),H=(0,r.useRef)(j),O=(0,r.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";$.current&&($.current.scrollTo({top:$.current.scrollHeight,behavior:e}),q(!1))}),[]),W=(0,r.useCallback)((()=>{const e=$.current;if(!e)return;const t=e.scrollHeight-e.scrollTop-e.clientHeight<10;q(!t)}),[]),P=(0,r.useMemo)((()=>f()(W,100)),[W]),R=(0,r.useCallback)((()=>{setTimeout((()=>{const e=document.querySelector("textarea."+u.A.chatInput)||document.querySelector('textarea[aria-label="Chat message input"]');e&&e.focus()}),100)}),[]);(0,r.useEffect)((()=>{R()}),[R]),(0,r.useEffect)((()=>{if(H.current&&!j){!(y||A||b||k)&&R()}H.current=j}),[j,y,A,b,k,R]),(0,r.useEffect)((()=>{const e=$.current;if(e)return P(),e.addEventListener("scroll",P,{passive:!0}),()=>{e.removeEventListener("scroll",P),P.cancel()}}),[P]),(0,r.useEffect)((()=>{const e=$.current;if(!e)return;const t=()=>{const t=e.scrollHeight-e.scrollTop-e.clientHeight<10;q(!t)};return t(),e.addEventListener("scroll",t,{passive:!0}),()=>e.removeEventListener("scroll",t)}),[I]),(0,r.useEffect)((()=>{const e=setTimeout((()=>P()),100);return()=>clearTimeout(e)}),[x,P]);const F=null==t?void 0:t.name,L=null==t?void 0:t.provider,_=(0,r.useCallback)((e=>{j||(w(e),setTimeout((()=>{const e=document.querySelector(`.${u.A.fixedInputArea}`);e&&e.scrollIntoView({behavior:"smooth"})}),100))}),[j]),z=(0,r.useCallback)((()=>{w(null)}),[]);(0,r.useEffect)((()=>{j&&k&&w(null)}),[j,k]);const D=`${u.A.chatContainer} ${E?u.A.activeChat:u.A.emptyChat} ${k?u.A.editingMode:""}`,B=e=>{const t=!e;return(0,m.jsxs)(m.Fragment,{children:[e&&!k&&(0,m.jsx)(r.Suspense,{fallback:(0,m.jsx)("div",{className:u.A.globalMetricsPlaceholder}),children:(0,m.jsx)(g,{metrics:null==S?void 0:S.session,modelName:null==M?void 0:M.name})}),(0,m.jsx)("div",{className:u.A.inputControlsWrapper,children:(0,m.jsx)(r.Suspense,{fallback:(0,m.jsx)("div",{className:u.A.inputPlaceholder}),children:(0,m.jsx)(p,{onSendMessage:N,disabled:j,selectedModel:M,onNewChat:i,isStaticLayout:t,editingMessage:k,onCancelEdit:z,isStreaming:j,toggleModelSelector:s,onFocus:R})})})]})};(0,r.useCallback)((()=>{document.querySelector(`.${u.A.inputContainer}`)||document.querySelector(`.${u.A.fixedInputArea}`)}),[]);return(0,m.jsxs)("div",{className:D,children:[(0,m.jsx)("div",{className:u.A.modelButtonContainer,children:(0,m.jsx)(r.Suspense,{fallback:null,children:(0,m.jsx)(v,{selectedModelName:F,providerName:L,onClick:s,disabled:n})})}),(0,m.jsxs)("div",{className:u.A.chatAreaWrapper,children:[(0,m.jsx)("div",{className:u.A.chatArea,children:E?(0,m.jsx)("div",{className:u.A.scrollContainer,ref:$,children:(0,m.jsx)("div",{className:u.A.scrollInner,children:(0,m.jsx)(r.Suspense,{fallback:(0,m.jsx)("div",{className:u.A.messagePlaceholder}),children:(0,m.jsx)(h,{ref:T,messages:x,error:C,onEditMessage:_})})})}):(0,m.jsxs)("div",{className:u.A.emptyChatContent,children:[(0,m.jsxs)("div",{className:u.A.greetingMessage,children:[(0,m.jsx)("h2",{children:"Welcome to AI Chat!"}),(0,m.jsx)("p",{children:"Select a model above and start your conversation."})]}),(0,m.jsx)("div",{className:`${u.A.inputArea} ${u.A.staticInputArea}`,children:B(!1)})]})}),I&&E&&(0,m.jsx)("button",{className:u.A.scrollToBottomButton,onClick:()=>O("smooth"),"aria-label":"Scroll to bottom",title:"Scroll to bottom",children:(0,m.jsx)(c.D3D,{size:20})})]}),E&&(0,m.jsx)("div",{className:`${u.A.inputArea} ${u.A.fixedInputArea}`,children:B(!0)})]})}));y.displayName="ChatContainer";const A=y},70381:(e,t,n)=>{var r="Expected a function",s=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,d=c||u||Function("return this")(),f=Object.prototype.toString,m=Math.max,h=Math.min,p=function(){return d.Date.now()};function g(e,t,n){var s,i,o,a,l,c,u=0,d=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError(r);function A(t){var n=s,r=i;return s=i=void 0,u=t,a=e.apply(r,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=o}function x(){var e=p();if(b(e))return j(e);l=setTimeout(x,function(e){var n=t-(e-c);return f?h(n,o-(e-u)):n}(e))}function j(e){return l=void 0,g&&s?A(e):(s=i=void 0,a)}function C(){var e=p(),n=b(e);if(s=arguments,i=this,c=e,n){if(void 0===l)return function(e){return u=e,l=setTimeout(x,t),d?A(e):a}(c);if(f)return l=setTimeout(x,t),A(c)}return void 0===l&&(l=setTimeout(x,t)),a}return t=y(t)||0,v(n)&&(d=!!n.leading,o=(f="maxWait"in n)?m(y(n.maxWait)||0,t):o,g="trailing"in n?!!n.trailing:g),C.cancel=function(){void 0!==l&&clearTimeout(l),u=0,s=c=i=l=void 0},C.flush=function(){return void 0===l?a:j(p())},C}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=o.test(e);return n||a.test(e)?l(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var s=!0,i=!0;if("function"!=typeof e)throw new TypeError(r);return v(n)&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),g(e,t,{leading:s,maxWait:t,trailing:i})}}}]);
//# sourceMappingURL=chat-container.ab2751ce.chunk.js.map