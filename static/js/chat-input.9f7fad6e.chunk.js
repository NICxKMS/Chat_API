"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[7218],{19217:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var i=r(65043),n=r(94692),s=r(63823),l=r(92503),o=r(92167),a=r(70579);const c=e=>new Promise(((t,r)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=e=>r(e),i.readAsDataURL(e)})),u=(0,i.memo)((e=>{var t,r;let{onSendMessage:u,onNewChat:d,disabled:h=!1,selectedModel:m,isStaticLayout:g=!1,editingMessage:x=null,onCancelEdit:p,isStreaming:w=!1,toggleModelSelector:f,onFocus:v}=e;const[y,j]=(0,i.useState)(""),[b,C]=(0,i.useState)([]),A=(0,i.useRef)(null),E=(0,i.useRef)(null),S=!!x,[k,N]=(0,i.useState)(window.innerWidth<=600),{isWaitingForResponse:$}=(0,l.P)(),{stopGeneration:z}=(0,o.r)();(0,i.useEffect)((()=>{const e=()=>{N(window.innerWidth<=600)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,i.useEffect)((()=>{A.current&&A.current.focus()}),[]),(0,i.useEffect)((()=>{if(x){let e="";const t=[];"string"==typeof x.content?e=x.content:Array.isArray(x.content)&&x.content.forEach((r=>{var i;"text"===r.type&&(e+=r.text||""),"image_url"===r.type&&null!==(i=r.image_url)&&void 0!==i&&i.url&&t.push({name:"",url:r.image_url.url})})),j(e),C(t),setTimeout((()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.focus()}),0)}}),[x]);const B=(0,i.useCallback)((()=>{const e=A.current;if(!e)return;e.style.height="auto";const t=Math.min(e.scrollHeight+2,200);e.style.height=`${t}px`;const r=e.closest(".inputContainer")||e.closest(`.${s.A.inputContainer}`);r&&(r.style.height="auto")}),[]);(0,i.useEffect)((()=>{B()}),[y,B]);const L=()=>{var e;null===(e=E.current)||void 0===e||e.click()},R=()=>{p&&p(),j(""),C([])},M=()=>{const e=y.trim().length>0,t=b.length>0;if(!e&&!t||h)return;if(!m&&f)return void f();const r=[];e&&r.push({type:"text",text:y.trim()}),t&&b.forEach((e=>{r.push({type:"image_url",image_url:{url:e.url}})})),r.length>0&&u(r,S?x:null),j(""),C([]),S&&p&&p(),A.current&&(A.current.style.height="auto",setTimeout((()=>{var e;return null===(e=A.current)||void 0===e?void 0:e.focus()}),0))},P=S?"Edit your message...":$?"Type your next message while waiting...":"Ask anything";return(0,i.useEffect)((()=>{if(!k)return;const e=()=>{window.innerHeight<.75*window.outerHeight?document.body.classList.add("keyboard-open"):document.body.classList.remove("keyboard-open")},t=()=>{k&&(document.body.classList.add("keyboard-open"),window.addEventListener("resize",e)),v&&v()},r=()=>{k&&(document.body.classList.remove("keyboard-open"),window.removeEventListener("resize",e))},i=A.current;return i&&(i.addEventListener("focus",t),i.addEventListener("blur",r)),()=>{i&&(i.removeEventListener("focus",t),i.removeEventListener("blur",r)),window.removeEventListener("resize",e)}}),[k,A,v]),(0,i.useEffect)((()=>{A.current&&A.current.focus()}),[]),(0,a.jsxs)(a.Fragment,{children:[b.length>0&&(0,a.jsx)("div",{className:s.A.imagePreviewContainer,children:b.map(((e,t)=>(0,a.jsxs)("div",{className:s.A.imagePreviewWrapper,children:[(0,a.jsx)("img",{src:e.url,alt:`preview ${t}`,className:s.A.imagePreview}),(0,a.jsx)("button",{className:s.A.removeImageButton,onClick:()=>{return e=t,void C((t=>t.filter(((t,r)=>r!==e))));var e},"aria-label":`Remove image ${t+1}`,title:`Remove image ${t+1}`,children:(0,a.jsx)(n.uv5,{size:12})})]},t)))}),(0,a.jsxs)("div",{className:`${s.A.inputContainer} ${S?s.A.editing:""} ${$?s.A.waitingForResponse:""} ${k?s.A.mobileView:""}`,children:[(0,a.jsx)("input",{type:"file",ref:E,style:{display:"none"},accept:"image/jpeg, image/png, image/gif, image/webp",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files);if(!t.length)return;if(b.length+t.length>5)return alert("You can upload a maximum of 5 images."),void(E.current&&(E.current.value=""));try{const e=t.map((async e=>{if(!e.type.startsWith("image/"))throw new Error(`File ${e.name} is not a valid image type.`);if(e.size>5242880)throw new Error(`File ${e.name} exceeds the 5MB size limit.`);const t=await c(e);return{name:e.name,url:t}})),r=await Promise.all(e);C((e=>[...e,...r]))}catch(e){alert(`Error processing images: ${e.message}`)}E.current&&(E.current.value="")}}),(0,a.jsxs)("div",{className:`${s.A.inputWrapper} ${m?"":s.A.noModelSelected}`,children:[(0,a.jsx)("textarea",{ref:A,className:s.A.chatInput,placeholder:P,value:y,onChange:e=>{j(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey?S&&"Escape"===e.key&&(e.preventDefault(),R()):(e.preventDefault(),!$&&(y.trim()||b.length>0)&&(!m&&f?f():M()))},onPaste:async e=>{var t;if(S)return;const r=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!r)return;const i=Array.from(r).filter((e=>e.type.startsWith("image/")));if(0===i.length)return;if(b.length+i.length>5)alert("You can upload a maximum of 5 images.");else try{const t=i.map((async e=>{const t=e.getAsFile();if(t.size>5242880)throw new Error("Pasted image exceeds the 5MB size limit.");const r=await c(t);return{name:"pasted-image-"+Date.now(),url:r}})),r=await Promise.all(t);C((e=>[...e,...r])),r.length>0&&e.preventDefault()}catch(e){alert(`Error processing pasted images: ${e.message}`)}},disabled:h,rows:1,"aria-label":"Chat message input"}),(0,a.jsx)("button",{className:`${s.A.sendButtonInline} ${$?s.A.stopButton:""} ${m?"":s.A.noModelSelected}`,onClick:e=>{e.preventDefault(),e.stopPropagation(),$?z():!m&&(y.trim()||b.length>0)?f&&f():M(),k&&A.current&&A.current.blur()},disabled:!$&&(!y.trim()&&0===b.length||h),"aria-label":$?"Stop generation":m?S?"Save edit":"Send message":"Select model",title:$?"Stop generation":m?S?"Save edit (Enter)":"Send message (Enter)":"Select a model",type:"button",children:$?(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"21",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}):m?S?(0,a.jsx)(n.Srz,{size:21}):(0,a.jsx)(n.GD3,{size:21}):(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]}),(0,a.jsxs)("div",{className:s.A.actionRow,children:[(0,a.jsxs)("div",{className:s.A.leftButtons,children:[(0,a.jsx)("button",{className:s.A.uploadButton,onClick:f?m?L:f:L,disabled:h,"aria-label":null!=m&&null!==(t=m.capabilities)&&void 0!==t&&t.includes("vision")?"Upload images":"Select model for image upload",title:null!=m&&null!==(r=m.capabilities)&&void 0!==r&&r.includes("vision")?"Upload images":"Select model for image upload",type:"button",children:(0,a.jsx)(n.xfq,{size:16})}),(0,a.jsxs)("button",{className:`${s.A.textButton} ${k?s.A.iconOnlyButton:""}`,"aria-label":"Search",title:"Search",type:"button",children:[(0,a.jsx)(n.WIv,{size:16}),!k&&(0,a.jsx)("span",{className:s.A.buttonText,children:"Search"})]}),(0,a.jsxs)("button",{className:`${s.A.textButton} ${k?s.A.iconOnlyButton:""}`,"aria-label":"Reason mode",title:"Reason mode",type:"button",children:[(0,a.jsx)(n.XLj,{size:16}),!k&&(0,a.jsx)("span",{className:s.A.buttonText,children:"Reason"})]}),(0,a.jsx)("button",{className:s.A.actionButton,"aria-label":"More options",title:"More options",type:"button",children:(0,a.jsx)(n.tno,{size:16})})]}),(0,a.jsxs)("div",{className:s.A.rightButtons,children:[(0,a.jsx)("button",{className:s.A.actionButton,onClick:d,"aria-label":"New chat",title:"New chat",type:"button",children:(0,a.jsx)(n.c11,{size:16})}),S&&(0,a.jsx)("button",{className:s.A.uploadButton,onClick:R,"aria-label":"Cancel edit",title:"Cancel edit (Esc)",type:"button",children:(0,a.jsx)(n.uv5,{size:16})}),(0,a.jsx)("button",{className:s.A.modelButton,onClick:f,"aria-label":"Select AI model",title:"Select AI model",type:"button",children:(0,a.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,a.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})]})]})]})}))}}]);
//# sourceMappingURL=chat-input.9f7fad6e.chunk.js.map