"use strict";(self.webpackChunkai_chat_interface=self.webpackChunkai_chat_interface||[]).push([[7218],{19217:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var r=i(65043),n=i(94692),s=i(63823),l=i(23708),o=i(70579);const a=e=>new Promise(((t,i)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=e=>i(e),r.readAsDataURL(e)})),c=(0,r.memo)((e=>{var t,i;let{onSendMessage:c,onNewChat:u,disabled:d=!1,selectedModel:h,isStaticLayout:m=!1,editingMessage:g=null,onCancelEdit:x,isStreaming:f=!1,toggleModelSelector:p,onFocus:w}=e;const[v,y]=(0,r.useState)(""),[j,b]=(0,r.useState)([]),C=(0,r.useRef)(null),A=(0,r.useRef)(null),E=!!g,[S,k]=(0,r.useState)(window.innerWidth<=600),{isWaitingForResponse:N,stopGeneration:$}=(0,l.Y_)();(0,r.useEffect)((()=>{const e=()=>{k(window.innerWidth<=600)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{C.current&&C.current.focus()}),[]),(0,r.useEffect)((()=>{if(g){let e="";if("string"==typeof g.content)e=g.content;else if(Array.isArray(g.content)){const t=g.content.find((e=>"text"===e.type));t&&(e=t.text||"")}y(e),setTimeout((()=>{C.current&&C.current.focus()}),0)}}),[g]);const z=(0,r.useCallback)((()=>{const e=C.current;if(!e)return;e.style.height="auto";const t=Math.min(e.scrollHeight+2,200);e.style.height=`${t}px`;const i=e.closest(".inputContainer")||e.closest(`.${s.A.inputContainer}`);i&&(i.style.height="auto")}),[]);(0,r.useEffect)((()=>{z()}),[v,z]);const B=()=>{var e;null===(e=A.current)||void 0===e||e.click()},L=()=>{x&&x(),y("")},R=()=>{const e=v.trim().length>0,t=!E&&j.length>0;if(!e&&!t||d)return;if(!h&&p)return void p();const i=[];e&&i.push({type:"text",text:v.trim()}),t&&j.forEach((e=>{i.push({type:"image_url",image_url:{url:e.url}})})),i.length>0&&c(i,E?g:null),y(""),b([]),E&&x&&x(),C.current&&(C.current.style.height="auto",setTimeout((()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.focus()}),0))},M=E?"Edit your message...":N?"Type your next message while waiting...":"Ask anything";return(0,r.useEffect)((()=>{if(!S)return;const e=()=>{window.innerHeight<.75*window.outerHeight?document.body.classList.add("keyboard-open"):document.body.classList.remove("keyboard-open")},t=()=>{S&&(document.body.classList.add("keyboard-open"),window.addEventListener("resize",e)),w&&w()},i=()=>{S&&(document.body.classList.remove("keyboard-open"),window.removeEventListener("resize",e))},r=C.current;return r&&(r.addEventListener("focus",t),r.addEventListener("blur",i)),()=>{r&&(r.removeEventListener("focus",t),r.removeEventListener("blur",i)),window.removeEventListener("resize",e)}}),[S,C,w]),(0,r.useEffect)((()=>{C.current&&C.current.focus()}),[]),(0,o.jsxs)(o.Fragment,{children:[j.length>0&&(0,o.jsx)("div",{className:s.A.imagePreviewContainer,children:j.map(((e,t)=>(0,o.jsxs)("div",{className:s.A.imagePreviewWrapper,children:[(0,o.jsx)("img",{src:e.url,alt:`preview ${t}`,className:s.A.imagePreview}),(0,o.jsx)("button",{className:s.A.removeImageButton,onClick:()=>{return e=t,void b((t=>t.filter(((t,i)=>i!==e))));var e},"aria-label":`Remove image ${t+1}`,title:`Remove image ${t+1}`,children:(0,o.jsx)(n.uv5,{size:12})})]},t)))}),(0,o.jsxs)("div",{className:`${s.A.inputContainer} ${E?s.A.editing:""} ${N?s.A.waitingForResponse:""} ${S?s.A.mobileView:""}`,children:[(0,o.jsx)("input",{type:"file",ref:A,style:{display:"none"},accept:"image/jpeg, image/png, image/gif, image/webp",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files);if(!t.length)return;if(j.length+t.length>5)return alert("You can upload a maximum of 5 images."),void(A.current&&(A.current.value=""));try{const e=t.map((async e=>{if(!e.type.startsWith("image/"))throw new Error(`File ${e.name} is not a valid image type.`);if(e.size>5242880)throw new Error(`File ${e.name} exceeds the 5MB size limit.`);const t=await a(e);return{name:e.name,url:t}})),i=await Promise.all(e);b((e=>[...e,...i]))}catch(e){alert(`Error processing images: ${e.message}`)}A.current&&(A.current.value="")}}),(0,o.jsxs)("div",{className:`${s.A.inputWrapper} ${h?"":s.A.noModelSelected}`,children:[(0,o.jsx)("textarea",{ref:C,className:s.A.chatInput,placeholder:M,value:v,onChange:e=>{y(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey?E&&"Escape"===e.key&&(e.preventDefault(),L()):(e.preventDefault(),!N&&(v.trim()||j.length>0)&&(!h&&p?p():R()))},onPaste:async e=>{var t;if(E)return;const i=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!i)return;const r=Array.from(i).filter((e=>e.type.startsWith("image/")));if(0===r.length)return;if(j.length+r.length>5)alert("You can upload a maximum of 5 images.");else try{const t=r.map((async e=>{const t=e.getAsFile();if(t.size>5242880)throw new Error("Pasted image exceeds the 5MB size limit.");const i=await a(t);return{name:"pasted-image-"+Date.now(),url:i}})),i=await Promise.all(t);b((e=>[...e,...i])),i.length>0&&e.preventDefault()}catch(e){alert(`Error processing pasted images: ${e.message}`)}},disabled:d,rows:1,"aria-label":"Chat message input"}),(0,o.jsx)("button",{className:`${s.A.sendButtonInline} ${N?s.A.stopButton:""} ${h?"":s.A.noModelSelected}`,onClick:e=>{e.preventDefault(),e.stopPropagation(),N?$():!h&&(v.trim()||j.length>0)?p&&p():R(),S&&C.current&&C.current.blur()},disabled:!N&&(!v.trim()&&0===j.length||d),"aria-label":N?"Stop generation":h?E?"Save edit":"Send message":"Select model",title:N?"Stop generation":h?E?"Save edit (Enter)":"Send message (Enter)":"Select a model",type:"button",children:N?(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"21",height:"21",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}):h?E?(0,o.jsx)(n.Srz,{size:21}):(0,o.jsx)(n.GD3,{size:21}):(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]}),(0,o.jsxs)("div",{className:s.A.actionRow,children:[(0,o.jsxs)("div",{className:s.A.leftButtons,children:[!E&&(0,o.jsx)("button",{className:s.A.uploadButton,onClick:p?h?B:p:B,disabled:d,"aria-label":null!=h&&null!==(t=h.capabilities)&&void 0!==t&&t.includes("vision")?"Upload images":"Select model for image upload",title:null!=h&&null!==(i=h.capabilities)&&void 0!==i&&i.includes("vision")?"Upload images":"Select model for image upload",type:"button",children:(0,o.jsx)(n.xfq,{size:16})}),(0,o.jsxs)("button",{className:`${s.A.textButton} ${S?s.A.iconOnlyButton:""}`,"aria-label":"Search",title:"Search",type:"button",children:[(0,o.jsx)(n.WIv,{size:16}),!S&&(0,o.jsx)("span",{className:s.A.buttonText,children:"Search"})]}),(0,o.jsxs)("button",{className:`${s.A.textButton} ${S?s.A.iconOnlyButton:""}`,"aria-label":"Reason mode",title:"Reason mode",type:"button",children:[(0,o.jsx)(n.XLj,{size:16}),!S&&(0,o.jsx)("span",{className:s.A.buttonText,children:"Reason"})]}),(0,o.jsx)("button",{className:s.A.actionButton,"aria-label":"More options",title:"More options",type:"button",children:(0,o.jsx)(n.tno,{size:16})})]}),(0,o.jsxs)("div",{className:s.A.rightButtons,children:[(0,o.jsx)("button",{className:s.A.actionButton,onClick:u,"aria-label":"New chat",title:"New chat",type:"button",children:(0,o.jsx)(n.c11,{size:16})}),E&&(0,o.jsx)("button",{className:s.A.uploadButton,onClick:L,"aria-label":"Cancel edit",title:"Cancel edit (Esc)",type:"button",children:(0,o.jsx)(n.uv5,{size:16})}),(0,o.jsx)("button",{className:s.A.modelButton,onClick:p,"aria-label":"Select AI model",title:"Select AI model",type:"button",children:(0,o.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"3",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"3",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"7",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"3",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"7",y:"11",width:"2",height:"2",fill:"currentColor"}),(0,o.jsx)("rect",{x:"11",y:"11",width:"2",height:"2",fill:"currentColor"})]})})]})]})]})]})}))}}]);
//# sourceMappingURL=chat-input.9a794673.chunk.js.map