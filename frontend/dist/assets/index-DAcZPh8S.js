const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebaseConfig-BCNoxiWp.js","assets/firebase-7FRIWL1f.js","assets/vendor-idb-CFK1l90-.js","assets/vendor-tslib-Cv3dJDD7.js","assets/index-Bjp1aayD.js","assets/react-syntax-highlighter-rQgkRzde.js","assets/framework--d6mMtcS.js","assets/vendor-prop-types-CQCrBv66.js","assets/vendor-property-information-Bqm-w5SU.js","assets/vendor-unist-util-visit-CYGNQgsi.js","assets/vendor-hast-util-whitespace-Be7pfeyt.js","assets/vendor-space-separated-tokens-DO9R2H4G.js","assets/vendor-comma-separated-tokens-Df9LWCSf.js","assets/vendor-style-to-object-CxqtyswF.js","assets/vendor-inline-style-parser-D8_Zmyug.js","assets/vendor-bail-gCPcOVbC.js","assets/vendor-extend-tA__Z666.js","assets/vendor-is-plain-obj-DeEdtHJQ.js","assets/vendor-trough-zzWXwSIo.js","assets/vendor-vfile-C7KQ_xuq.js","assets/vendor-unist-util-stringify-position-CvSG9YTx.js","assets/vendor-mdast-util-from-markdown-PW8VQj7v.js","assets/vendor-micromark-CT66Bizv.js","assets/vendor-micromark-util-combine-extensions-D0lltlzb.js","assets/vendor-micromark-util-chunked-3k3e5hER.js","assets/vendor-micromark-factory-space-BuxqzSY_.js","assets/vendor-micromark-core-commonmark-CKya-DGW.js","assets/vendor-micromark-util-classify-character-xDUcR3gG.js","assets/vendor-micromark-util-resolve-all-U8fstr8o.js","assets/vendor-decode-named-character-reference-C-EXV6yX.js","assets/vendor-micromark-util-subtokenize-BM4KMHVE.js","assets/vendor-micromark-factory-destination-B-3w5mMe.js","assets/vendor-micromark-factory-label-Cod0aiTB.js","assets/vendor-micromark-factory-title-CWRBDKzc.js","assets/vendor-micromark-factory-whitespace-YzaPLww_.js","assets/vendor-micromark-util-normalize-identifier-CzKtq1sx.js","assets/vendor-micromark-util-html-tag-name-DbKNfynz.js","assets/vendor-micromark-util-decode-numeric-character-reference-qd59qYy-.js","assets/vendor-micromark-util-decode-string-DNFV-wAX.js","assets/vendor-mdast-util-to-string-Ck87fAyN.js","assets/vendor-remark-rehype-CW3p_88l.js","assets/vendor-trim-lines-C03Dth7Y.js","assets/vendor-mdast-util-definitions-BogZMgA2.js","assets/vendor-unist-util-generated-Bn-sJWM5.js","assets/vendor-babel-n5kzynIe.js","assets/refractor-core-CPle4AHE.js","assets/vendor-hastscript-DOIm2S7G.js","assets/vendor-xtend-Bx3ujlEJ.js","assets/vendor-hast-util-parse-selector-j38Qpric.js","assets/vendor-parse-entities-D4Dt79sy.js","assets/vendor-character-entities-legacy-C0-9l53Z.js","assets/vendor-character-reference-invalid-CXGT0v6U.js","assets/vendor-is-decimal-J_H0W03Q.js","assets/vendor-is-hexadecimal-B1wGafkN.js","assets/vendor-is-alphanumerical-z9x4zqKd.js","assets/vendor-is-alphabetical-Y2TTKzg7.js","assets/refractor-markup-CNhLbOs4.js","assets/refractor-css-D0oVyIz7.js","assets/refractor-clike-CzH4jCHD.js","assets/refractor-javascript-Bcy-LhR2.js","assets/index-XHxVTWhD.css","assets/index-y8PTocmW.js","assets/utils-DyE1HC8q.js","assets/index-B3qEmQYH.css","assets/index-C-FADSuX.js","assets/index-CUkdfWPK.css","assets/index-CQPrrWVa.js","assets/index-i5uC8zgQ.css","assets/index-CefDO3yf.js","assets/useProfilePicture-Ba4pQBF9.js","assets/index-CREY9YLS.css","assets/index-n-1t9HFB.js","assets/index-DfmrZXdv.css","assets/buttons-CD1l72uO.css","assets/index-B5KJkhEx.js","assets/index-CcKEZoR9.css","assets/index-NlB2RBNk.js","assets/index-CvDBG7j3.css","assets/index-JkVf9C-T.js","assets/index-oS9gNJ4d.css","assets/index-DixaA6-v.js","assets/index-DN5YhMiD.css","assets/LoginModal-B2ut-5TS.js","assets/LoginModal-BgQmFLjw.css","assets/MarkdownRenderer-D0YqQJdC.js","assets/markdown-D1yvlx7T.js","assets/vendor-micromark-extension-gfm-682ExYu2.js","assets/vendor-micromark-extension-gfm-autolink-literal-BvFU5B_M.js","assets/vendor-micromark-extension-gfm-footnote-BMow1uuh.js","assets/vendor-micromark-extension-gfm-strikethrough-DVLz2FyR.js","assets/vendor-micromark-extension-gfm-table-CFIISn7F.js","assets/vendor-micromark-extension-gfm-task-list-item-D0FwQzEf.js","assets/vendor-mdast-util-gfm-CITVQFii.js","assets/vendor-mdast-util-gfm-autolink-literal-C2X8JGT0.js","assets/vendor-ccount-D181NsKZ.js","assets/vendor-mdast-util-gfm-footnote-50hpPH2M.js","assets/vendor-mdast-util-to-markdown-DDpRuohb.js","assets/vendor-mdast-util-gfm-strikethrough-D1nk-Ogr.js","assets/vendor-mdast-util-gfm-table-0sjzvTgl.js","assets/vendor-markdown-table-BkNFvfyU.js","assets/vendor-mdast-util-gfm-task-list-item-BpXst3II.js","assets/vendor-micromark-extension-math-BZxG7iC7.js","assets/katex-Bv4lR2hj.js","assets/vendor-hast-util-from-html-isomorphic-ClxbSYim.js","assets/vendor-hast-util-from-dom-zfHBih9y.js","assets/vendor-web-namespaces-Cmx0dTen.js","assets/vendor-unist-util-visit-parents-DG4pNz9n.js","assets/vendor-unist-util-is-C5Jwnfs7.js","assets/vendor-hast-util-to-text-DoIMjO1v.js","assets/vendor-hast-util-is-element-Djts9Lmg.js","assets/vendor-unist-util-find-after-CQmqb-to.js","assets/katex-DVneG3Rq.css","assets/vendor-mdast-util-math-DMJofKo6.js","assets/vendor-longest-streak-D3RFUi6d.js","assets/vendor-node-emoji-DYLhFgjT.js","assets/vendor-sindresorhus-DhiBqWQZ.js","assets/vendor-emojilib-CaOLuxD8.js","assets/vendor-char-regex-C1IE5pyU.js","assets/vendor-emoticon-Cw9dttd9.js","assets/vendor-mdast-util-find-and-replace-0DgvSoin.js","assets/StreamingMessage-Bk4GS9U5.js","assets/formatters-KC3wC9z7.js","assets/formatters-BBWjJVcj.css"])))=>i.map(i=>d[i]);
import{j as e,r as t,a as r,R as n}from"./framework--d6mMtcS.js";import{_ as o}from"./react-syntax-highlighter-rQgkRzde.js";import{d as s}from"./utils-DyE1HC8q.js";import"./vendor-prop-types-CQCrBv66.js";import"./vendor-property-information-Bqm-w5SU.js";import"./vendor-unist-util-visit-CYGNQgsi.js";import"./vendor-hast-util-whitespace-Be7pfeyt.js";import"./vendor-space-separated-tokens-DO9R2H4G.js";import"./vendor-comma-separated-tokens-Df9LWCSf.js";import"./vendor-style-to-object-CxqtyswF.js";import"./vendor-inline-style-parser-D8_Zmyug.js";import"./vendor-bail-gCPcOVbC.js";import"./vendor-extend-tA__Z666.js";import"./vendor-is-plain-obj-DeEdtHJQ.js";import"./vendor-trough-zzWXwSIo.js";import"./vendor-vfile-C7KQ_xuq.js";import"./vendor-unist-util-stringify-position-CvSG9YTx.js";import"./vendor-mdast-util-from-markdown-PW8VQj7v.js";import"./vendor-micromark-CT66Bizv.js";import"./vendor-micromark-util-combine-extensions-D0lltlzb.js";import"./vendor-micromark-util-chunked-3k3e5hER.js";import"./vendor-micromark-factory-space-BuxqzSY_.js";import"./vendor-micromark-core-commonmark-CKya-DGW.js";import"./vendor-micromark-util-classify-character-xDUcR3gG.js";import"./vendor-micromark-util-resolve-all-U8fstr8o.js";import"./vendor-decode-named-character-reference-C-EXV6yX.js";import"./vendor-micromark-util-subtokenize-BM4KMHVE.js";import"./vendor-micromark-factory-destination-B-3w5mMe.js";import"./vendor-micromark-factory-label-Cod0aiTB.js";import"./vendor-micromark-factory-title-CWRBDKzc.js";import"./vendor-micromark-factory-whitespace-YzaPLww_.js";import"./vendor-micromark-util-normalize-identifier-CzKtq1sx.js";import"./vendor-micromark-util-html-tag-name-DbKNfynz.js";import"./vendor-micromark-util-decode-numeric-character-reference-qd59qYy-.js";import"./vendor-micromark-util-decode-string-DNFV-wAX.js";import"./vendor-mdast-util-to-string-Ck87fAyN.js";import"./vendor-remark-rehype-CW3p_88l.js";import"./vendor-trim-lines-C03Dth7Y.js";import"./vendor-mdast-util-definitions-BogZMgA2.js";import"./vendor-unist-util-generated-Bn-sJWM5.js";import"./vendor-babel-n5kzynIe.js";import"./refractor-core-CPle4AHE.js";import"./vendor-hastscript-DOIm2S7G.js";import"./vendor-xtend-Bx3ujlEJ.js";import"./vendor-hast-util-parse-selector-j38Qpric.js";import"./vendor-parse-entities-D4Dt79sy.js";import"./vendor-character-entities-legacy-C0-9l53Z.js";import"./vendor-character-reference-invalid-CXGT0v6U.js";import"./vendor-is-decimal-J_H0W03Q.js";import"./vendor-is-hexadecimal-B1wGafkN.js";import"./vendor-is-alphanumerical-z9x4zqKd.js";import"./vendor-is-alphabetical-Y2TTKzg7.js";import"./refractor-markup-CNhLbOs4.js";import"./refractor-css-D0oVyIz7.js";import"./refractor-clike-CzH4jCHD.js";import"./refractor-javascript-Bcy-LhR2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const a={toastContainer:"_toastContainer_1apvt_1",toast:"_toast_1apvt_1",slideIn:"_slideIn_1apvt_1",error:"_error_1apvt_26",success:"_success_1apvt_29",info:"_info_1apvt_32",warning:"_warning_1apvt_35",message:"_message_1apvt_39",closeButton:"_closeButton_1apvt_44"},i=({toasts:t,dismissToast:r})=>e.jsx("div",{className:a.toastContainer,children:t.map((t=>e.jsxs("div",{className:`${a.toast} ${a[t.type]||""}`,children:[e.jsx("span",{className:a.message,children:t.message}),e.jsx("button",{type:"button",className:a.closeButton,onClick:()=>r(t.id),"aria-label":"Close notification",children:"Ã—"})]},t.id)))}),c=t.createContext(),l=()=>{const e=t.useContext(c);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},d="ADD_TOAST",u="REMOVE_TOAST";function m(e,t){switch(t.type){case d:return[...e,t.payload];case u:return e.filter((e=>e.id!==t.payload));default:return e}}const g=({children:r})=>{const[n,o]=t.useReducer(m,[]),s=t.useCallback((({type:e,message:t,duration:r=3e3})=>{const n=Date.now().toString()+Math.random().toString(36).substr(2,9);return o({type:d,payload:{id:n,type:e,message:t,duration:r}}),setTimeout((()=>o({type:u,payload:n})),r),n}),[]),a=t.useCallback((e=>{o({type:u,payload:e})}),[]);return e.jsxs(c.Provider,{value:{showToast:s,dismissToast:a},children:[r,e.jsx(i,{toasts:n,dismissToast:a})]})},p=t.createContext(null),h=({children:r})=>{const[n,o]=t.useState({}),s=t.useCallback(((e,t)=>{o((r=>({...r,[e]:t})))}),[]),a=t.useCallback((e=>!!n[e]),[n]),i=Object.values(n).some((e=>e));return e.jsx(p.Provider,{value:{setLoading:s,isLoading:a,anyLoading:i},children:r})},C=e=>{const r=t.useContext(p);if(!r)throw new Error("useLoading must be used within LoadingProvider");const{setLoading:n,isLoading:o}=r,s=t.useCallback((()=>n(e,!0)),[n,e]),a=t.useCallback((()=>n(e,!1)),[n,e]);return[o(e),s,a]},I=t.createContext(),y=()=>{const e=t.useContext(I);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},f=({children:r})=>{const[n,s]=t.useState(null),[a,i]=t.useState(null),[c,d]=t.useState(!1),[,u,m]=C("auth"),[g,p]=t.useState(null),[h,y]=t.useState(!1),[f,w]=t.useState(!1),{showToast:A}=l();t.useEffect((()=>{c?u():m()}),[c,u,m]);const v=t.useCallback((async()=>{y(!0)}),[y]),b=t.useCallback((async()=>{if(!f)return;const{getFirebaseAuth:e}=await o((async()=>{const{getFirebaseAuth:e}=await import("./firebaseConfig-BCNoxiWp.js");return{getFirebaseAuth:e}}),__vite__mapDeps([0,1,2,3])),{signOut:t}=await o((async()=>{const{signOut:e}=await import("./firebase-7FRIWL1f.js");return{signOut:e}}),__vite__mapDeps([1,2,3])),r=e();if(!r){const e="Firebase not initialized.";return p(e),void A({type:"error",message:e})}try{await t(r)}catch(n){const e=n.message||"Failed to logout.";p(e),A({type:"error",message:e})}}),[f,p,A]);t.useEffect((()=>{let e=null;const t=()=>{w(!0),r()},r=async()=>{d(!0);const{getFirebaseAuth:t}=await o((async()=>{const{getFirebaseAuth:e}=await import("./firebaseConfig-BCNoxiWp.js");return{getFirebaseAuth:e}}),__vite__mapDeps([0,1,2,3])),{onAuthStateChanged:r}=await o((async()=>{const{onAuthStateChanged:e}=await import("./firebase-7FRIWL1f.js");return{onAuthStateChanged:e}}),__vite__mapDeps([1,2,3])),n=t();n?e=r(n,(async e=>{if(s(e),e)try{const r=await e.getIdToken();i(r);try{localStorage.setItem("idToken",r)}catch(t){}p(null),y(!1)}catch(r){const e="Failed to get authentication token.";p(e),A({type:"error",message:e}),i(null);const{signOut:t}=await o((async()=>{const{signOut:e}=await import("./firebase-7FRIWL1f.js");return{signOut:e}}),__vite__mapDeps([1,2,3]));await t(n)}else{i(null);try{localStorage.removeItem("idToken")}catch(t){}y(!1)}d(!1)})):d(!1)};return window.addEventListener("firebaseInitialized",t),()=>{window.removeEventListener("firebaseInitialized",t),"function"==typeof e&&e()}}),[A]);const k=t.useMemo((()=>({currentUser:n,idToken:a,loading:c,error:g,login:v,logout:b,isAuthenticated:!!n&&!!a,isLoggingIn:h,setIsLoggingIn:y,isFirebaseInitialized:f})),[n,a,c,g,v,b,h,y,f]);return e.jsx(I.Provider,{value:k,children:r})},w=t.createContext(),A=()=>{const e=t.useContext(w);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e},v=({children:r})=>{const[n,o]=t.useState((()=>localStorage.getItem("theme")||"dark")),s=t.useCallback((()=>{o((e=>{const t="dark"===e?"light":"dark";return localStorage.setItem("theme",t),t}))}),[]);t.useEffect((()=>{(()=>{if(document.body.classList.remove("light-mode","dark-mode"),"system"===n){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.body.classList.add(e?"dark-mode":"light-mode")}else document.body.classList.add(`${n}-mode`)})()}),[n]),t.useEffect((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{"system"===n&&(document.body.classList.remove("light-mode","dark-mode"),document.body.classList.add(e.matches?"dark-mode":"light-mode"))};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}),[n]);const a=t.useMemo((()=>({theme:n,toggleTheme:s,isDark:"dark"===n})),[n,s]);return e.jsx(w.Provider,{value:a,children:r})},b=t.createContext(),k=()=>{const e=t.useContext(b);if(void 0===e)throw new Error("useApi must be used within an ApiProvider");return e},_=({children:r})=>{const[n]=t.useState("http://localhost:3000/api"),o=t.useMemo((()=>({apiUrl:n})),[n]);return e.jsx(b.Provider,{value:o,children:r})},j=(e,r)=>{const n=t.useRef(r),[o,s]=t.useState((()=>{try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):n.current}catch(t){return n.current}})),a=t.useCallback((t=>{try{const r=t instanceof Function?t(o):t;s(r),window.localStorage.setItem(e,JSON.stringify(r))}catch(r){}}),[e,o]);return t.useEffect((()=>{try{const t=window.localStorage.getItem(e);s(t?JSON.parse(t):n.current)}catch(t){s(n.current)}}),[e]),[o,a]},S=()=>{const[e,r]=j("modelCacheEnabled",!0),n=t.useCallback((()=>{try{localStorage.removeItem("modelDropdownCache")}catch(e){}}),[]),o=t.useCallback((t=>{const o="boolean"==typeof t?t:!e;return o||n(),r(o),o}),[e,r,n]),s=t.useCallback((()=>{n()}),[n]);return t.useEffect((()=>{if("undefined"==typeof window)return;const e=window.isCacheValid;return window.isCacheValid=function(t){return"false"!==localStorage.getItem("modelCacheEnabled")&&("function"==typeof e?e(t):t&&t.timestamp&&Date.now()-t.timestamp<3e5&&t.allModels&&t.processedModels&&t.experimentalModels)},()=>{window.isCacheValid=e}}),[]),{cacheEnabled:e,toggleCache:o,clearModelCache:n,refreshModels:s}},T=t.createContext(),x=t.createContext(),R=()=>{const e=t.useContext(T);if(void 0===e)throw new Error("useModel must be used within a ModelProvider");return e},E=()=>{const e=t.useContext(x);if(void 0===e)throw new Error("useModelFilter must be used within a ModelProvider");return e},M=({children:r})=>{const{cacheEnabled:n}=S(),{apiUrl:o}=k(),{idToken:s}=y(),{showToast:a}=l(),[i,c]=t.useState([]),[d,u]=t.useState({}),[m,g]=t.useState([]),[p,h]=j("selectedModel",null),[I,f]=t.useState(!0),[w,A]=t.useState(null),[v,b]=j("showExperimental",!1),[_,R]=t.useState({search:"",categories:{Chat:!0,Image:!0,Embedding:!0}}),[,E,M]=C("models");t.useEffect((()=>{I?E():M()}),[I,E,M]);const L=t.useCallback((e=>e&&e.timestamp&&Date.now()-e.timestamp<432e6&&e.allModels&&e.processedModels&&e.experimentalModels),[]);t.useEffect((()=>{if("undefined"!=typeof window)return window.isCacheValid=L,()=>{delete window.isCacheValid}}),[L]);const B=t.useCallback((e=>{try{const t={allModels:e.allModels,processedModels:e.processedModels,experimentalModels:e.experimentalModels,timestamp:Date.now()};localStorage.setItem("modelDropdownCache",JSON.stringify(t))}catch(t){}}),[]),G=t.useCallback(((e,t)=>{R((r=>({...r,categories:{...r.categories,[e]:t}})))}),[]),W=t.useCallback((e=>{R((t=>({...t,search:e})))}),[]),F=t.useCallback((e=>{(null==p?void 0:p.id)!==(null==e?void 0:e.id)&&h(e)}),[p,h]),P=t.useCallback((async(e=!1,t=null)=>{f(!0),A(null);try{const r={Accept:"application/json"};if(e){const e=t||s;e&&(r.Authorization=`Bearer ${e}`)}const i=new URL("/api/models/classified",o).toString(),l=await fetch(i,{headers:r});if(!l.ok){let e=`Error fetching models: ${l.status}`;throw new Error(e)}const d=await l.json(),m=new Worker(new URL("/assets/modelProcessor-BeiRJotf.js",import.meta.url),{type:"module"});m.postMessage(d),m.onmessage=({data:e})=>{if(e.error)A(e.error),a({type:"error",message:e.error});else{const{allModels:t,processedModels:r,experimentalModels:o}=e;if(n){const e=localStorage.getItem("modelDropdownCache");let n;try{n=JSON.parse(e)}catch{n=null}(!n||JSON.stringify(n.allModels)!==JSON.stringify(t)||JSON.stringify(n.processedModels)!==JSON.stringify(r)||JSON.stringify(n.experimentalModels)!==JSON.stringify(o))&&(c(t),u(r),g(o),B({allModels:t,processedModels:r,experimentalModels:o}))}else c(t),u(r),g(o)}f(!1),m.terminate()},m.onerror=e=>{A(e.message),a({type:"error",message:e.message}),f(!1),m.terminate()}}catch(r){A(r.message||"Failed to load model data"),a({type:"error",message:r.message||"Failed to load model data"})}}),[o,B,s,n,a]),Z=t.useRef(!1),V=t.useRef(!1);t.useEffect((()=>{if(!Z.current){if(n){const e=localStorage.getItem("modelDropdownCache");let t;try{t=JSON.parse(e)}catch{t=null}t&&window.isCacheValid(t)&&(c(t.allModels),u(t.processedModels),g(t.experimentalModels),f(!1))}let e=null;try{e=localStorage.getItem("idToken")}catch{}e?(V.current=!0,P(!0,e)):P(!1),Z.current=!0}}),[]),t.useEffect((()=>{Z.current&&s&&!V.current&&(V.current=!0,P(!0))}),[s,P]),t.useEffect((()=>{!p&&i.length>0&&h(i[0])}),[i,p,h]);const N=t.useCallback((()=>{b((e=>!e))}),[b]),O=t.useMemo((()=>({allModels:i,processedModels:d,experimentalModels:m,selectedModel:p,isLoading:I,error:w,showExperimental:v,isExperimentalModelsEnabled:v,toggleExperimentalModels:N,setShowExperimental:b,selectModel:F,refreshModels:P})),[i,d,m,p,I,w,v,N,b,F,P]),H=t.useMemo((()=>({modelFilter:_,updateCategoryFilter:G,updateSearchFilter:W})),[_,G,W]);return e.jsx(T.Provider,{value:O,children:e.jsx(x.Provider,{value:H,children:r})})},L={temperature:.7,top_p:1,max_tokens:8191,frequency_penalty:0,presence_penalty:0,streaming:!0,systemPrompt:'You are a knowledgeable, friendly, and supportive university-level assistant.\n\nFor every question or topic, provide a clear, engaging, and well-structured answer, styled like an expert mentor or senior student.\n\nStyle and Structure:\n\nBegin with a welcoming, positive intro (e.g., "Alright! I\'ll break this down for you in detail section by section, with clear explanations and important points.").\nOrganize your response into numbered sections, each with a descriptive header and an emoji (e.g., # ðŸ“š 1. Core Concept).\nIn each section, explain:\nCore ideas and definitions\nHow things work (step-by-step, or process overview)\nAny relevant formulas, code, or examples\nKey points, tips, or comparisons\nUse subheadings, bullet points, tables, and diagrams (ASCII or LaTeX) for clarity when helpful.\nAt the end, summarize with a "Key Takeaways" or "Next Steps/Related Topics" section, with quick revision notes, further reading, or suggestions for deeper exploration if relevant.\nAlways offer to provide summary tables, code snippets, or quick revision notes if the user wants them.\nTone: Friendly, supportive, and approachableâ€”like a helpful peer or mentor. Formatting: Use bold, italics, emojis, markdown headers, and tables to maximize clarity.\n\nUse emojis befitting the context\n\nYour goal: Make complex ideas easy to understand, memorable, and actionable for the studentâ€”whether for study, projects, or curiosity.'},B=t.createContext(),G=()=>{const e=t.useContext(B);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e},W=({children:r})=>{const[n,o]=j("appSettings",L),s=t.useCallback(((e,t)=>{e in L&&o((r=>({...r,[e]:t})))}),[o]),a=t.useCallback((()=>{o(L)}),[o]),i=t.useCallback((e=>!!e&&(!0===e.requiresFixedTemperature||e.properties&&e.properties.includes("fixed_temperature")||e.id&&e.id.toLowerCase().startsWith("o")||e.series&&"o-series"===e.series.toLowerCase())),[]),c=t.useCallback((e=>i(e)?{...n,temperature:1}:n),[n,i]),l=t.useMemo((()=>({settings:n,updateSetting:s,resetSettings:a,shouldRestrictTemperature:i,getModelAdjustedSettings:c})),[n,s,a,i,c]);return e.jsx(B.Provider,{value:l,children:r})},F=t.createContext(),P=()=>{const e=t.useContext(F);if(void 0===e)throw new Error("useChatStatus must be used within a ChatStatusProvider");return e},Z=({children:r})=>{const[n,o]=t.useState(!1),[s,a]=t.useState(null),[,i,c]=C("chat");t.useEffect((()=>{n?i():c()}),[n,i,c]);const l=t.useMemo((()=>({isWaitingForResponse:n,setIsWaitingForResponse:o,error:s,setError:a})),[n,s]);return e.jsx(F.Provider,{value:l,children:r})},V=t.createContext(),N=()=>{const e=t.useContext(V);if(void 0===e)throw new Error("useChatHistory must be used within a ChatHistoryProvider");return e},O=({children:r})=>{const[n,o]=t.useState([]),s=t.useRef([]),a=t.useCallback((e=>{o((t=>{const r="function"==typeof e?e(t):e;return s.current=r,r}))}),[]),i=t.useCallback(((e,t,r)=>{const n=Date.now(),o={id:n,role:e,content:t,timestamp:n,...r&&{metrics:r}};return a((e=>[...e,o])),o}),[a]),c=t.useCallback((e=>{a((t=>{const r=t.length-1;if(r<0)return t;const n=t[r];if("assistant"!==n.role||n.content===e)return t;const o=[...t];return o[r]={...n,content:e},o}))}),[a]),l=t.useMemo((()=>({chatHistory:n,chatHistoryRef:s,setChatHistory:a,addMessageToHistory:i,updateChatWithContent:c})),[n,a,i,c]);return e.jsx(V.Provider,{value:l,children:r})},H=t.createContext(),z=()=>{const e=t.useContext(H);if(void 0===e)throw new Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e},Y=({children:r})=>{const{setChatHistory:n}=N(),[o,s]=t.useState({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null}),a=t.useCallback((()=>{s({startTime:null,endTime:null,elapsedTime:null,tokenCount:null,tokensPerSecond:null,isComplete:!1,timeToFirstToken:null,promptTokens:null,completionTokens:null,totalTokens:null,finishReason:null})}),[]),i=t.useCallback((()=>{s((e=>({...e,startTime:Date.now(),isComplete:!1})))}),[]),c=t.useCallback(((e,t=!1,r=null,n=null)=>{s((o=>{const s=Date.now(),a=o.startTime?s-o.startTime:0,i=e&&a?Math.round(e/(a/1e3)*10)/10:o.tokensPerSecond,c=o.timeToFirstToken||(e>0?a:null);return{startTime:o.startTime,endTime:s,elapsedTime:a,tokenCount:e,tokensPerSecond:i,isComplete:t,timeToFirstToken:c,promptTokens:(null==r?void 0:r.promptTokens)||o.promptTokens,completionTokens:(null==r?void 0:r.completionTokens)||o.completionTokens,totalTokens:(null==r?void 0:r.totalTokens)||o.totalTokens,finishReason:n||o.finishReason}}))}),[]);t.useEffect((()=>{null!=o.endTime&&n((e=>{const t=[...e],r=t[t.length-1];return r&&"assistant"===r.role&&(r.metrics={...o}),t}))}),[o,n]);const l=t.useCallback((e=>{n((t=>{const r=[...t],n=r[r.length-1];return n&&"assistant"===n.role&&(n.metrics={...n.metrics||{},...e,isComplete:!0}),r}))}),[n]),d=t.useMemo((()=>({currentMessageMetrics:o,resetPerformanceMetrics:a,startPerformanceTimer:i,updatePerformanceMetrics:c,setTokenMetricsForLastMessage:l})),[o,a,i,c,l]);return e.jsx(H.Provider,{value:d,children:r})};async function U(e,t={},r=3,n=500){let o=0;for(;;)try{const r=await fetch(e,t);if(!r.ok)throw new Error(`Network error: ${r.status}`);return r}catch(s){if(o>=r)throw s;const e=n*Math.pow(2,o)+100*Math.random();await new Promise((t=>setTimeout(t,e))),o++}}const D=t.createContext(),X=({children:r})=>{const{apiUrl:n}=k(),{selectedModel:o}=R(),{getModelAdjustedSettings:a}=G(),{idToken:i}=y(),{chatHistoryRef:c,setChatHistory:l,addMessageToHistory:d,updateChatWithContent:u}=N(),{setIsWaitingForResponse:m,setError:g}=P(),{resetPerformanceMetrics:p,startPerformanceTimer:h,updatePerformanceMetrics:C}=z(),I=t.useRef(""),f=t.useRef(null),w=t.useRef(null),A=t.useRef(!1),v=t.useRef(!1),b=t.useMemo((()=>s((e=>u(e)),20)),[u]),_=t.useRef(null),j=t.useRef(null),S=t.useCallback((()=>(j.current||(_.current||(_.current=new URL("data:text/javascript;base64,LyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovCgovLyBzdHJlYW1Qcm9jZXNzb3IuanMKLy8gV2ViIFdvcmtlciB0byBwYXJzZSBTU0Ugc3RyZWFtaW5nIGNodW5rcyBpbnRvIGNvbnRlbnQgKyB0b2tlbkNvdW50CgpzZWxmLm9ubWVzc2FnZSA9ICh7IGRhdGE6IGNodW5rIH0pID0+IHsKICAvLyBkYXRhIGlzIHRoZSByYXcgY2h1bmsgc3RyaW5nIGZyb20gZmV0Y2ggc3RyZWFtcwogIGNvbnN0IG1lc3NhZ2VzID0gW107CiAgY29uc3QgcGFydHMgPSBjaHVuay5zcGxpdCgnXG5cbicpOwoKICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydHMpIHsKICAgIGlmICghcGFydC50cmltKCkpIGNvbnRpbnVlOwogICAgaWYgKHBhcnQuc3RhcnRzV2l0aCgnOmhlYXJ0YmVhdCcpKSBjb250aW51ZTsKICAgIGlmIChwYXJ0LnN0YXJ0c1dpdGgoJ2RhdGE6JykpIHsKICAgICAgY29uc3QgcGF5bG9hZCA9IHBhcnQuc2xpY2UoNSkudHJpbSgpOwogICAgICBpZiAocGF5bG9hZCA9PT0gJ1tET05FXScpIHsKICAgICAgICBtZXNzYWdlcy5wdXNoKHsgaXNEb25lOiB0cnVlIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHBheWxvYWQpOwogICAgICAgICAgCiAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGlzIHRoZSBmaW5hbCBjaHVuayB3aXRoIGNvbXBsZXRlIG1ldGFkYXRhCiAgICAgICAgICAvLyBMb29rIGZvciB0aGUgc3BlY2lmaWMgZm9ybWF0IGZyb20gdGhlIGV4YW1wbGUKICAgICAgICAgIGNvbnN0IGlzRmluYWxDaHVuayA9IHBhcnNlZC5pZCAmJiBwYXJzZWQubW9kZWwgJiYgcGFyc2VkLnVzYWdlOwogICAgICAgICAgCiAgICAgICAgICBjb25zdCBjb250ZW50ID0gcGFyc2VkLmNvbnRlbnQgfHwgJyc7CiAgICAgICAgICAKICAgICAgICAgIC8vIEV4dHJhY3QgdG9rZW4gZGV0YWlscyBpZiBhdmFpbGFibGUKICAgICAgICAgIGxldCB0b2tlbkluZm8gPSBudWxsOwogICAgICAgICAgCiAgICAgICAgICAvLyBQcmlvcml0eTogT3BlbkFJIHJhdy51c2FnZSBmb3IgdXNhZ2UgbWV0YWRhdGEgKHNuYWtlX2Nhc2UpCiAgICAgICAgICBpZiAocGFyc2VkLnJhdz8udXNhZ2UpIHsKICAgICAgICAgICAgY29uc3QgdSA9IHBhcnNlZC5yYXcudXNhZ2U7CiAgICAgICAgICAgIHRva2VuSW5mbyA9IHsKICAgICAgICAgICAgICBwcm9tcHRUb2tlbnM6IHUucHJvbXB0X3Rva2VucyA/PyB1LnByb21wdFRva2VucywKICAgICAgICAgICAgICBjb21wbGV0aW9uVG9rZW5zOiB1LmNvbXBsZXRpb25fdG9rZW5zID8/IHUuY29tcGxldGlvblRva2VucywKICAgICAgICAgICAgICB0b3RhbFRva2VuczogdS50b3RhbF90b2tlbnMgPz8gdS50b3RhbFRva2VucwogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zb2xlLmxvZygiW1dPUktFUl0gRm91bmQgcmF3LnVzYWdlOiIsIHRva2VuSW5mbyk7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcnNlZC51c2FnZSkgewogICAgICAgICAgICAvLyBEaXJlY3QgbWF0Y2ggdG8gdGhlIHByb3ZpZGVkIGV4YW1wbGUKICAgICAgICAgICAgdG9rZW5JbmZvID0gewogICAgICAgICAgICAgIHByb21wdFRva2VuczogcGFyc2VkLnVzYWdlLnByb21wdFRva2VucywKICAgICAgICAgICAgICBjb21wbGV0aW9uVG9rZW5zOiBwYXJzZWQudXNhZ2UuY29tcGxldGlvblRva2VucywKICAgICAgICAgICAgICB0b3RhbFRva2VuczogcGFyc2VkLnVzYWdlLnRvdGFsVG9rZW5zCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJbV09SS0VSXSBGb3VuZCB1c2FnZSBkYXRhOiIsIHRva2VuSW5mbyk7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcnNlZC5yYXc/LnVzYWdlTWV0YWRhdGEpIHsKICAgICAgICAgICAgdG9rZW5JbmZvID0gewogICAgICAgICAgICAgIHByb21wdFRva2VuczogcGFyc2VkLnJhdy51c2FnZU1ldGFkYXRhLnByb21wdFRva2VuQ291bnQsCiAgICAgICAgICAgICAgY29tcGxldGlvblRva2VuczogcGFyc2VkLnJhdy51c2FnZU1ldGFkYXRhLmNhbmRpZGF0ZXNUb2tlbkNvdW50LAogICAgICAgICAgICAgIHRvdGFsVG9rZW5zOiBwYXJzZWQucmF3LnVzYWdlTWV0YWRhdGEudG90YWxUb2tlbkNvdW50CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJbV09SS0VSXSBGb3VuZCByYXcudXNhZ2VNZXRhZGF0YToiLCB0b2tlbkluZm8pOwogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICBtZXNzYWdlcy5wdXNoKHsKICAgICAgICAgICAgY29udGVudCwKICAgICAgICAgICAgLy8gRm9yd2FyZCBzZXJ2ZXIgdXNhZ2UgbWV0YWRhdGEgb25seTsgbm8gY2xpZW50LXNpZGUgdG9rZW5Db3VudAogICAgICAgICAgICB1c2FnZTogdG9rZW5JbmZvLAogICAgICAgICAgICBmaW5pc2hSZWFzb246IHBhcnNlZC5maW5pc2hSZWFzb24sCiAgICAgICAgICAgIG1vZGVsOiBwYXJzZWQubW9kZWwsCiAgICAgICAgICAgIHByb3ZpZGVyOiBwYXJzZWQucHJvdmlkZXIsCiAgICAgICAgICAgIGlzRmluYWxDaHVuaywKICAgICAgICAgICAgcmF3Q2h1bms6IHBhcnNlZAogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgLy8gaWdub3JlIHBhcnNlIGVycm9ycwogICAgICAgICAgY29uc29sZS5lcnJvcigiW1dPUktFUl0gUGFyc2UgZXJyb3I6IiwgZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICAvLyBTZW5kIHBhcnNlZCBtZXNzYWdlcyBiYWNrIHRvIG1haW4gdGhyZWFkCiAgc2VsZi5wb3N0TWVzc2FnZShtZXNzYWdlcyk7Cn07IA==",import.meta.url)),j.current=new Worker(_.current,{type:"module"})),j.current)),[]),T=t.useCallback((e=>new Promise(((t,r)=>{const n=S();n.onmessage=e=>t(e.data),n.onerror=r,n.postMessage(e)}))),[S]),x=t.useCallback((async(e,t=null)=>{var r,s,y,k;const _="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2)+Date.now().toString(36);f.current=_;const j=null!==t&&Number.isInteger(t)&&t>=0;if(!e||!o)return g("Please enter a message and select a model"),null;const S=`${o.provider}/${o.id}`;if(!S)return g("Invalid model selection"),null;let x;j?l((r=>{const n=r.slice(0,t),o=r[t];return x={...o,content:e},[...n,x]})):x=d("user",e),p(),h(),v.current=!1,m(!0),g(null),I.current="",A.current=!0,d("assistant","");let R=setTimeout((()=>{var e;null==(e=w.current)||e.abort("timeout"),g("Connection timed out"),m(!1)}),6e4);const E=new AbortController;w.current=E;try{const e=a(o),t=c.current.map((({metrics:e,...t})=>t));!e.systemPrompt||t.length&&"system"===t[0].role||t.unshift({role:"system",content:e.systemPrompt,timestamp:Date.now()-1}),t.push(x);const d={requestId:_,model:S,messages:t,temperature:e.temperature,max_tokens:e.max_tokens,top_p:e.top_p,frequency_penalty:e.frequency_penalty,presence_penalty:e.presence_penalty},p={"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"};i&&(p.Authorization=`Bearer ${i}`);const h=await U(new URL("/api/chat/stream",n).toString(),{method:"POST",headers:p,body:JSON.stringify(d),signal:E.signal,cache:"no-store"});if(!h.ok)throw new Error(`API error: ${h.status}`);const f=h.body.getReader(),A=new TextDecoder("utf-8");let j="";for(;;){const{done:e,value:t}=await f.read();if(clearTimeout(R),R=setTimeout((()=>{var e;null==(e=w.current)||e.abort(),g("Connection timed out"),m(!1)}),6e4),e)break;const n=A.decode(t,{stream:!0});try{const e=await T(n);for(const t of e){if((null==(r=t.rawChunk)?void 0:r.error)||"error"===t.finishReason){const e=(null==(y=null==(s=t.rawChunk)?void 0:s.error)?void 0:y.message)||"Error occurred during generation";return g(e),l((t=>{const r=[...t],n=r[r.length-1];return n&&"assistant"===n.role&&(n.content+=`\n\n**Error:** ${e}`,n.metrics&&(n.metrics.isComplete=!0,n.metrics.error=!0)),r})),null}t.content&&(v.current||(C(1),v.current=!0),j+=t.content,I.current=j,b(j));const e=(null==(k=t.usage)?void 0:k.completionTokens)??0;C(e,t.isDone,t.usage,t.finishReason)}}catch{}}return b.flush(),u(I.current),I.current}catch(M){return g(M.message),l((e=>{const t=[...e],r=t[t.length-1];return r&&"assistant"===r.role&&(r.content+=`\n\n**Error:** ${M.message||"Error occurred during generation"}`,r.metrics&&(r.metrics.isComplete=!0,r.metrics.error=!0)),t})),null}finally{clearTimeout(R),A.current=!1,m(!1),f.current=null}}),[n,o,a,i,c,l,d,u,b,g,m,p,h,C,T]),E=t.useCallback((async()=>{w.current&&w.current.abort("user_stopped");const e=f.current;if(e){const t={"Content-Type":"application/json"};i&&(t.Authorization=`Bearer ${i}`);try{await U(new URL("/api/chat/stop",n).toString(),{method:"POST",headers:t,body:JSON.stringify({requestId:e})})}catch{}finally{f.current=null,w.current=null}}return A.current=!1,m(!1),!0}),[n,i,m]),M=t.useMemo((()=>({streamMessageWithFetch:x,stopStreaming:E,parseStreamChunk:T,streamingTextRef:I,isStreaming:()=>A.current})),[x,E,T]);return e.jsx(D.Provider,{value:M,children:r})},J=t.createContext(),K=()=>{const e=t.useContext(J);if(void 0===e)throw new Error("useChatState must be used within a ChatStateProvider");return e},Q=({children:r})=>{const{chatHistory:n,chatHistoryRef:o}=N(),{isWaitingForResponse:s,error:a}=P(),i=t.useMemo((()=>({chatHistory:n,chatHistoryRef:o,isWaitingForResponse:s,error:a})),[n,o,s,a]);return e.jsx(J.Provider,{value:i,children:r})},$=t.createContext(),q=()=>{const e=t.useContext($);if(void 0===e)throw new Error("useChatControl must be used within a ChatControlProvider");return e},ee=({children:r})=>{const n=t.useRef(null),{apiUrl:o}=k(),{selectedModel:s}=R(),{settings:a,getModelAdjustedSettings:i}=G(),{idToken:c}=y(),{chatHistoryRef:d,setChatHistory:u,addMessageToHistory:m}=N(),{setIsWaitingForResponse:g,setError:p}=P(),{resetPerformanceMetrics:h,startPerformanceTimer:C,setTokenMetricsForLastMessage:I}=z(),{streamMessageWithFetch:f,stopStreaming:w}=(()=>{const e=t.useContext(D);if(void 0===e)throw new Error("useStreamingEvents must be used within a StreamingEventsProvider");return e})(),{showToast:A}=l(),v=t.useCallback((e=>e&&e.provider&&e.id?`${e.provider}/${e.id}`:null),[]),b=t.useCallback((async(e,t=null)=>{var r,l,I;const y="undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2)+Date.now().toString(36);n.current=y;const w=null!==t&&Number.isInteger(t)&&t>=0;if(a.streaming)return f(e,w?t:null);if(!e||!s)return p("Please enter a message and select a model"),null;const A=v(s);if(!A)return p("Invalid model selection"),null;let b;w?u((r=>{const n=r.slice(0,t),o=r[t];return b={...o,content:e},[...n,b]})):b=m("user",e);const k=Date.now();g(!0),p(null);try{const e=i(s),t=d.current.map((({metrics:e,...t})=>t));!e.systemPrompt||t.length&&"system"===t[0].role||t.unshift({role:"system",content:e.systemPrompt,timestamp:Date.now()-1}),t.push(b);const n={requestId:y,model:A,messages:t,temperature:e.temperature,max_tokens:e.max_tokens,top_p:e.top_p,frequency_penalty:e.frequency_penalty,presence_penalty:e.presence_penalty};h(),C();const a={"Content-Type":"application/json",Accept:"application/json"};c&&(a.Authorization=`Bearer ${c}`);const u=await U(new URL("/api/chat/completions",o).toString(),{method:"POST",headers:a,body:JSON.stringify(n)});if(!u.ok){let e=`API error: ${u.status}`;try{const t=await u.json();e=(null==(r=null==t?void 0:t.error)?void 0:r.message)||(null==t?void 0:t.message)||e}catch{}throw new Error(e)}const g=await u.json();if((null==(l=g.error)?void 0:l.message)||"error"===g.finishReason){const e=(null==(I=g.error)?void 0:I.message)||"Error occurred during generation";p(e);const t=g.usage||{},r=t.promptTokens??t.prompt_tokens??0,n=t.completionTokens??t.completion_tokens??0,o=t.totalTokens??t.total_tokens??n,s=Date.now(),a=s-k,i={startTime:k,endTime:s,elapsedTime:a,tokenCount:n,tokensPerSecond:a?Math.round(n/(a/1e3)*10)/10:null,isComplete:!0,timeToFirstToken:null,promptTokens:r,completionTokens:n,totalTokens:o,finishReason:g.finishReason||"error",error:!0};return m("assistant",e,i),null}const f=g.content||"No Response returned",w=g.usage||{},v=w.promptTokens??w.prompt_tokens??0,_=w.completionTokens??w.completion_tokens??0,j=w.totalTokens??w.total_tokens??_,S=Date.now(),T=S-k,x=_>0?_:0,R={startTime:k,endTime:S,elapsedTime:T,tokenCount:x,tokensPerSecond:T?Math.round(x/(T/1e3)*10)/10:null,isComplete:!0,timeToFirstToken:null,promptTokens:v,completionTokens:_,totalTokens:j,finishReason:g.finishReason};return m("assistant",f,R),f}catch(_){return p(_.message),m("assistant",_.message||"An error occurred"),null}finally{n.current=null,g(!1)}}),[o,s,a.streaming,i,c,d,u,m,f,v,h,C,p,g]),_=t.useCallback((async()=>(w(),!0)),[w]),j=t.useCallback((()=>{u([]),h()}),[u,h]),S=t.useCallback((()=>{d.current.length>0&&j()}),[d,j]),T=t.useCallback((()=>{0!==d.current.length&&window.confirm("Are you sure you want to clear the current chat?")&&(j(),A({type:"info",message:"Chat has been cleared"}))}),[d,j,A]),x=t.useCallback((()=>{const e=d.current;if(e.length)try{const t=e.map((e=>{const t="user"===e.role?"You":"assistant"===e.role?(null==s?void 0:s.name)||"Assistant":e.role;let r="";return"string"==typeof e.content?r=e.content:Array.isArray(e.content)&&(r=e.content.map((e=>"text"===e.type?e.text:"[Image]")).join("\n")),`${t}: ${r}\n`})).join(""),r=new Blob([t],{type:"text/plain"}),n=URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=`chat_${(new Date).toISOString().replace(/:/g,"-")}.txt`,document.body.appendChild(o),o.click(),A({type:"success",message:"Chat downloaded successfully"}),document.body.removeChild(o),URL.revokeObjectURL(n)}catch(t){A({type:"error",message:"Failed to download chat. Please try again."})}}),[d,s,A]),E=t.useCallback((e=>{}),[]),M=t.useMemo((()=>({sendMessage:b,stopGeneration:_,addMessageToHistory:m,clearChat:j,newChat:S,resetChat:T,downloadChat:x,getOrCreateConversation:E,setTokenMetricsForLastMessage:I})),[b,_,m,j,S,T,x,E,I]);return e.jsx($.Provider,{value:M,children:r})},te=t.createContext(null),re=({children:r})=>{const n=t.useMemo((()=>({isInitialized:!1,setInitialized:e=>{n.isInitialized=e}})),[]);return t.useEffect((()=>{n.setInitialized(!0)}),[n]),e.jsx(te.Provider,{value:n,children:e.jsx(v,{children:e.jsx(_,{children:e.jsx(M,{children:e.jsx(W,{children:e.jsx(Z,{children:e.jsx(O,{children:e.jsx(Y,{children:e.jsx(X,{children:e.jsx(Q,{children:e.jsx(ee,{children:r})})})})})})})})})})})},ne={Spinner:"_Spinner_7yw02_1",Spinner__loader:"_Spinner__loader_7yw02_8",rotate:"_rotate_7yw02_1","Spinner--small":"_Spinner--small_7yw02_41","Spinner--medium":"_Spinner--medium_7yw02_51","Spinner--large":"_Spinner--large_7yw02_61","Spinner--gradient":"_Spinner--gradient_7yw02_72","dark-mode":"_dark-mode_7yw02_82"},oe=({size:t="medium",tag:r})=>{const n=ne[`Spinner--${t}`]||ne["Spinner--medium"];return e.jsx("div",{className:`${ne.Spinner} ${n}`,"data-loading-tag":r,"aria-label":"Loading",role:"status",children:e.jsx("div",{className:ne.Spinner__loader})})},se=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ae="app-start",ie="component-load",ce="important-components-loaded",le="first-paint",de="first-contentful-paint",ue="app-interactive",me="component-load-time",ge="time-to-interactive",pe="important-load-time";const he=new class{constructor(){this.marks=new Set,this.measures=new Set,"undefined"!=typeof window&&"performance"in window&&"PerformanceObserver"in window&&this.trackPaintMetrics()}trackPaintMetrics(){try{new PerformanceObserver((e=>{e.getEntries().forEach((e=>{const t="first-paint"===e.name?le:de;performance.mark(t),this.marks.add(t);const r="first-paint"===e.name?"time-to-first-paint":"time-to-first-contentful-paint";try{performance.measure(r,ae,t),this.measures.add(r)}catch(n){}}))})).observe({entryTypes:["paint"]})}catch(e){}}mark(e){performance&&performance.mark&&(performance.mark(e),this.marks.add(e))}measure(e,t,r){if(performance&&performance.measure)try{performance.measure(e,t,r),this.measures.add(e)}catch(n){}}getMeasures(){return performance&&performance.getEntriesByType?performance.getEntriesByType("measure"):[]}clear(){performance&&(performance.clearMarks(),performance.clearMeasures(),this.marks.clear(),this.measures.clear())}logMetrics(){this.getMeasures().forEach((e=>{})),window}},Ce={layout:()=>o((()=>import("./index-Bjp1aayD.js").then((e=>e.i))),__vite__mapDeps([4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60])),chatContainer:()=>o((()=>import("./index-y8PTocmW.js")),__vite__mapDeps([61,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,63])),chatInput:()=>o((()=>import("./index-C-FADSuX.js")),__vite__mapDeps([64,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,65])),modelDropdown:()=>o((()=>import("./index-CQPrrWVa.js")),__vite__mapDeps([66,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,67])),sidebar:()=>o((()=>import("./index-CefDO3yf.js")),__vite__mapDeps([68,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,69,5,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,70])),themeToggle:()=>o((()=>import("./index-n-1t9HFB.js")),__vite__mapDeps([71,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,5,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,72,73])),sidebarToggle:()=>o((()=>import("./index-B5KJkhEx.js")),__vite__mapDeps([74,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,75])),messageList:()=>o((()=>import("./index-NlB2RBNk.js").then((e=>e.i))),__vite__mapDeps([76,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,69,77])),globalMetrics:()=>o((()=>import("./index-JkVf9C-T.js")),__vite__mapDeps([78,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,79])),moreActions:()=>o((()=>import("./index-DixaA6-v.js")),__vite__mapDeps([80,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,5,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,81,73]))},Ie=t.lazy(Ce.layout),ye=t.lazy((()=>o((()=>import("./LoginModal-B2ut-5TS.js")),__vite__mapDeps([82,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,62,83])))),fe={essential:Object.values(Ce),heavy:[()=>o((()=>import("./MarkdownRenderer-D0YqQJdC.js")),__vite__mapDeps([84,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119])),()=>o((()=>import("./StreamingMessage-Bk4GS9U5.js")),__vite__mapDeps([120,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,121,122,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,62])),()=>o((()=>import("./firebaseConfig-BCNoxiWp.js")),__vite__mapDeps([0,1,2,3])).then((()=>{window.dispatchEvent(new Event("firebaseInitialized"))}))]};function we(){const[r,n]=t.useState(!1),[o,s]=t.useState(!1),{isLoggingIn:a,setIsLoggingIn:i}=y();return t.useEffect((()=>{let e=!1;return async function(){he.mark(ae);try{await(async e=>{for(const t of e)await t()})(fe.essential),he.mark(ce),he.measure(pe,ae,ce),he.mark(ie),he.measure(me,ae,ie)}catch(t){}requestAnimationFrame((async()=>{var t,r;e||(n(!0),he.mark(ue),he.measure(ge,ae,ue),t=fe.heavy,r=e=>{e===fe.heavy.length-1&&s(!0)},requestIdleCallback((()=>{t.forEach(((e,t)=>e().then((()=>r(t))).catch((()=>{}))))})))}))}(),()=>{e=!0,he.clear()}}),[]),r?e.jsxs(e.Fragment,{children:[e.jsx(t.Suspense,{fallback:e.jsx(oe,{size:"small"}),children:e.jsx(Ie,{})}),a&&o&&e.jsx(t.Suspense,{fallback:e.jsx(oe,{size:"small"}),children:e.jsx(ye,{onClose:()=>i(!1)})})]}):e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:e.jsx(oe,{size:"medium"})})}function Ae(){return e.jsx(f,{children:e.jsx(re,{children:e.jsx(we,{})})})}const ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function be(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const r=e.installing;null!=r&&(r.onstatechange=()=>{"installed"===r.state&&(navigator.serviceWorker.controller?t&&t.onUpdate&&t.onUpdate(e):t&&t.onSuccess&&t.onSuccess(e))})}})).catch((e=>{}))}const ke=()=>{const[e]=C("auth"),r=e,{showToast:n,dismissToast:o}=l(),s=t.useRef(null);return t.useEffect((()=>(r?s.current=n({type:"info",message:"Loading in progress...",duration:0}):s.current&&(o(s.current),n({type:"success",message:"Loading complete",duration:2e3}),s.current=null),()=>{s.current&&(o(s.current),s.current=null)})),[r,n,o]),null},_e=window.matchMedia("(prefers-color-scheme: dark)").matches;document.body.classList.add(_e?"dark-mode":"light-mode");var je;r.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(g,{children:e.jsxs(h,{children:[e.jsx(t.Suspense,{fallback:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Loading..."}),children:e.jsx(Ae,{})}),e.jsx(ke,{})]})})})),(je=console.log)&&je instanceof Function&&o((async()=>{const{getCLS:e,getFID:t,getFCP:r,getLCP:n,getTTFB:o}=await import("./utils-DyE1HC8q.js").then((e=>e.w));return{getCLS:e,getFID:t,getFCP:r,getLCP:n,getTTFB:o}}),__vite__mapDeps([62,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])).then((({getCLS:e,getFID:t,getFCP:r,getLCP:n,getTTFB:o})=>{e(je),t(je),r(je),n(je),o(je)})),function(e){if("service-worker"in navigator){if(new URL(void 0,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="undefined/service-worker.js";ve?function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((r=>{const n=r.headers.get("content-type");404===r.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):be(e,t)})).catch((()=>{}))}(t,e):be(t,e)}))}}({onUpdate:e=>{const t=e.waiting;t&&(t.addEventListener("statechange",(e=>{"activated"===e.target.state&&window.location.reload()})),t.postMessage({type:"SKIP_WAITING"}))}});export{oe as S,y as a,A as b,K as c,q as d,G as e,E as f,S as g,j as h,se as i,R as u};
//# sourceMappingURL=index-DAcZPh8S.js.map
