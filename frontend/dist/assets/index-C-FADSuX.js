const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D3GWhlv-.js","assets/framework--d6mMtcS.js","assets/vendor-prop-types-CQCrBv66.js","assets/vendor-property-information-Bqm-w5SU.js","assets/vendor-unist-util-visit-CYGNQgsi.js","assets/vendor-hast-util-whitespace-Be7pfeyt.js","assets/vendor-space-separated-tokens-DO9R2H4G.js","assets/vendor-comma-separated-tokens-Df9LWCSf.js","assets/vendor-style-to-object-CxqtyswF.js","assets/vendor-inline-style-parser-D8_Zmyug.js","assets/vendor-bail-gCPcOVbC.js","assets/vendor-extend-tA__Z666.js","assets/vendor-is-plain-obj-DeEdtHJQ.js","assets/vendor-trough-zzWXwSIo.js","assets/vendor-vfile-C7KQ_xuq.js","assets/vendor-unist-util-stringify-position-CvSG9YTx.js","assets/vendor-mdast-util-from-markdown-PW8VQj7v.js","assets/vendor-micromark-CT66Bizv.js","assets/vendor-micromark-util-combine-extensions-D0lltlzb.js","assets/vendor-micromark-util-chunked-3k3e5hER.js","assets/vendor-micromark-factory-space-BuxqzSY_.js","assets/vendor-micromark-core-commonmark-CKya-DGW.js","assets/vendor-micromark-util-classify-character-xDUcR3gG.js","assets/vendor-micromark-util-resolve-all-U8fstr8o.js","assets/vendor-decode-named-character-reference-C-EXV6yX.js","assets/vendor-micromark-util-subtokenize-BM4KMHVE.js","assets/vendor-micromark-factory-destination-B-3w5mMe.js","assets/vendor-micromark-factory-label-Cod0aiTB.js","assets/vendor-micromark-factory-title-CWRBDKzc.js","assets/vendor-micromark-factory-whitespace-YzaPLww_.js","assets/vendor-micromark-util-normalize-identifier-CzKtq1sx.js","assets/vendor-micromark-util-html-tag-name-DbKNfynz.js","assets/vendor-micromark-util-decode-numeric-character-reference-qd59qYy-.js","assets/vendor-micromark-util-decode-string-DNFV-wAX.js","assets/vendor-mdast-util-to-string-Ck87fAyN.js","assets/vendor-remark-rehype-CW3p_88l.js","assets/vendor-trim-lines-C03Dth7Y.js","assets/vendor-mdast-util-definitions-BogZMgA2.js","assets/vendor-unist-util-generated-Bn-sJWM5.js","assets/index-CaAQ4ldD.css","assets/index-oGQQdRgl.js","assets/index-D6JyslrF.css","assets/index-Ds4iJnmC.js","assets/index-Ba9IQNOn.css"])))=>i.map(i=>d[i]);
import{_ as e}from"./react-syntax-highlighter-rQgkRzde.js";import{r as t,j as r}from"./framework--d6mMtcS.js";import{c as i,d as n}from"./index-DAcZPh8S.js";import"./vendor-babel-n5kzynIe.js";import"./refractor-core-CPle4AHE.js";import"./vendor-hastscript-DOIm2S7G.js";import"./vendor-xtend-Bx3ujlEJ.js";import"./vendor-hast-util-parse-selector-j38Qpric.js";import"./vendor-parse-entities-D4Dt79sy.js";import"./vendor-character-entities-legacy-C0-9l53Z.js";import"./vendor-character-reference-invalid-CXGT0v6U.js";import"./vendor-is-decimal-J_H0W03Q.js";import"./vendor-is-hexadecimal-B1wGafkN.js";import"./vendor-is-alphanumerical-z9x4zqKd.js";import"./vendor-is-alphabetical-Y2TTKzg7.js";import"./refractor-markup-CNhLbOs4.js";import"./refractor-css-D0oVyIz7.js";import"./refractor-clike-CzH4jCHD.js";import"./refractor-javascript-Bcy-LhR2.js";import"./vendor-prop-types-CQCrBv66.js";import"./vendor-property-information-Bqm-w5SU.js";import"./vendor-unist-util-visit-CYGNQgsi.js";import"./vendor-hast-util-whitespace-Be7pfeyt.js";import"./vendor-space-separated-tokens-DO9R2H4G.js";import"./vendor-comma-separated-tokens-Df9LWCSf.js";import"./vendor-style-to-object-CxqtyswF.js";import"./vendor-inline-style-parser-D8_Zmyug.js";import"./vendor-bail-gCPcOVbC.js";import"./vendor-extend-tA__Z666.js";import"./vendor-is-plain-obj-DeEdtHJQ.js";import"./vendor-trough-zzWXwSIo.js";import"./vendor-vfile-C7KQ_xuq.js";import"./vendor-unist-util-stringify-position-CvSG9YTx.js";import"./vendor-mdast-util-from-markdown-PW8VQj7v.js";import"./vendor-micromark-CT66Bizv.js";import"./vendor-micromark-util-combine-extensions-D0lltlzb.js";import"./vendor-micromark-util-chunked-3k3e5hER.js";import"./vendor-micromark-factory-space-BuxqzSY_.js";import"./vendor-micromark-core-commonmark-CKya-DGW.js";import"./vendor-micromark-util-classify-character-xDUcR3gG.js";import"./vendor-micromark-util-resolve-all-U8fstr8o.js";import"./vendor-decode-named-character-reference-C-EXV6yX.js";import"./vendor-micromark-util-subtokenize-BM4KMHVE.js";import"./vendor-micromark-factory-destination-B-3w5mMe.js";import"./vendor-micromark-factory-label-Cod0aiTB.js";import"./vendor-micromark-factory-title-CWRBDKzc.js";import"./vendor-micromark-factory-whitespace-YzaPLww_.js";import"./vendor-micromark-util-normalize-identifier-CzKtq1sx.js";import"./vendor-micromark-util-html-tag-name-DbKNfynz.js";import"./vendor-micromark-util-decode-numeric-character-reference-qd59qYy-.js";import"./vendor-micromark-util-decode-string-DNFV-wAX.js";import"./vendor-mdast-util-to-string-Ck87fAyN.js";import"./vendor-remark-rehype-CW3p_88l.js";import"./vendor-trim-lines-C03Dth7Y.js";import"./vendor-mdast-util-definitions-BogZMgA2.js";import"./vendor-unist-util-generated-Bn-sJWM5.js";import"./utils-DyE1HC8q.js";const o={ChatInput:"_ChatInput_zqfxx_1","ChatInput--waitingForResponse":"_ChatInput--waitingForResponse_zqfxx_80","ChatInput--editing":"_ChatInput--editing_zqfxx_101",ChatInput__error:"_ChatInput__error_zqfxx_212",ChatInput__mobileView:"_ChatInput__mobileView_zqfxx_253","ChatInput--mobileInitial":"_ChatInput--mobileInitial_zqfxx_387","ChatInput--mobileWithMessages":"_ChatInput--mobileWithMessages_zqfxx_394"},s=t.lazy((()=>e((()=>import("./index-D3GWhlv-.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39])))),a=t.lazy((()=>e((()=>import("./index-oGQQdRgl.js")),__vite__mapDeps([40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,41])))),l=t.lazy((()=>e((()=>import("./index-Ds4iJnmC.js")),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,43])))),c=e=>new Promise(((t,r)=>{const i=new FileReader;i.onload=()=>t(i.result),i.onerror=e=>r(e),i.readAsDataURL(e)})),m=t.memo((({disabled:e=!1,selectedModel:m=null,isStaticLayout:u=!1,editingMessage:d=null,onCancelEdit:p=()=>{},isStreaming:h=!1,toggleModelSelector:v=()=>{},onFocus:f=()=>{},isInitialChat:g=!1,onSendMessage:j})=>{const[y,_]=t.useState(""),[b,k]=t.useState([]),w=t.useRef(null),C=t.useRef(null),x=!!d,[E,I]=t.useState(window.innerWidth<=600),{isWaitingForResponse:z}=i(),{stopGeneration:L,newChat:M}=n(),[S,R]=t.useState(null),D=t.useRef(null);t.useEffect((()=>{const e=()=>I(window.innerWidth<=600);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),t.useEffect((()=>{var e;null==(e=w.current)||e.focus()}),[]),t.useEffect((()=>{if(d){let e="";const t=[];"string"==typeof d.content?e=d.content:Array.isArray(d.content)&&d.content.forEach((r=>{var i;"text"===r.type&&(e+=r.text||""),"image_url"===r.type&&(null==(i=r.image_url)?void 0:i.url)&&t.push({name:"",url:r.image_url.url})})),_(e),k(t),setTimeout((()=>{var e;return null==(e=w.current)?void 0:e.focus()}),0)}else _(""),k([])}),[d]);const A=t.useCallback((()=>{const e=w.current;if(!e)return;e.style.height="auto";const t=Math.min(e.scrollHeight+2,200);e.style.height=`${t}px`;const r=e.closest(`.${o.ChatInput}`);r&&r.style.setProperty("--textarea-height",`${t}px`)}),[]);t.useEffect((()=>{A()}),[y,A]),t.useEffect((()=>{if(!E)return;const e=()=>{const e=window.innerHeight<.75*window.outerHeight;document.body.classList.toggle("keyboard-open",e)},t=()=>{E&&(document.body.classList.add("keyboard-open"),window.addEventListener("resize",e)),f&&f()},r=()=>{E&&(document.body.classList.remove("keyboard-open"),window.removeEventListener("resize",e))},i=w.current;return i&&(i.addEventListener("focus",t),i.addEventListener("blur",r)),()=>{i&&(i.removeEventListener("focus",t),i.removeEventListener("blur",r)),window.removeEventListener("resize",e),document.body.classList.remove("keyboard-open")}}),[E,f]);const P=t.useCallback((e=>{R(e),D.current&&clearTimeout(D.current),D.current=setTimeout((()=>{R(null),D.current=null}),3e3)}),[]);t.useEffect((()=>()=>{D.current&&clearTimeout(D.current)}),[]);const F=t.useCallback((e=>{_(e.target.value)}),[]),T=t.useCallback((()=>{const t=y.trim().length>0,r=b.length>0;if(!t&&!r||e)return;if(!m&&v)return void v();const i=[];t&&i.push({type:"text",text:y.trim()}),r&&b.forEach((e=>i.push({type:"image_url",image_url:{url:e.url}}))),i.length>0&&j(i,x?d:null),_(""),k([]),x&&p&&p(),w.current&&(w.current.style.height="auto",setTimeout((()=>{var e;return null==(e=w.current)?void 0:e.focus()}),0))}),[y,b,e,m,v,j,x,d,p]),W=t.useCallback((e=>{"Enter"!==e.key||e.shiftKey?x&&"Escape"===e.key&&(e.preventDefault(),p&&p(),_(""),k([])):(e.preventDefault(),z||T())}),[z,T,x,p]),q=t.useCallback((async e=>{const t=Array.from(e.target.files);if(!t.length)return;if(b.length+t.length>5)return P("Max 5 images allowed."),void(C.current&&(C.current.value=""));try{const e=t.map((async e=>{if(!e.type.startsWith("image/"))throw new Error(`${e.name} invalid type.`);if(e.size>5242880)throw new Error(`${e.name} > 5MB.`);const t=await c(e);return{name:e.name,url:t}})),r=await Promise.all(e);k((e=>[...e,...r]))}catch(r){P(`Image error: ${r.message}`)}C.current&&(C.current.value="")}),[b.length,P]),$=t.useCallback((async e=>{var t;if(x)return;const r=null==(t=e.clipboardData)?void 0:t.items;if(!r)return;const i=Array.from(r).filter((e=>e.type.startsWith("image/")));if(0===i.length)return;if(b.length+i.length>5)P("Max 5 images allowed.");else try{const t=i.map((async e=>{const t=e.getAsFile();if(t.size>5242880)throw new Error("Pasted image > 5MB.");const r=await c(t);return{name:"pasted-"+Date.now(),url:r}})),r=await Promise.all(t);r.length>0&&(k((e=>[...e,...r])),e.preventDefault())}catch(n){P(`Paste error: ${n.message}`)}}),[x,b.length,P]),V=t.useCallback((e=>{k((t=>t.filter(((t,r)=>r!==e))))}),[]),B=t.useCallback((()=>{var e,t;!m&&v?v():(null==(e=null==m?void 0:m.capabilities)?void 0:e.includes("vision"))?null==(t=C.current)||t.click():P("Select a model with vision capabilities to upload images.")}),[m,v,P]),H=t.useCallback((()=>{p&&p(),_(""),k([])}),[p]),K=t.useCallback((()=>{L()}),[L]),N=t.useCallback((e=>{e.preventDefault(),e.stopPropagation(),z?K():T(),E&&w.current&&w.current.blur()}),[z,K,T,E]),O=x?"Edit your message...":z?"Type your next message while waiting...":"Ask anything";return r.jsxs(r.Fragment,{children:[r.jsx(t.Suspense,{fallback:null,children:r.jsx(s,{images:b,onRemoveImage:V})}),r.jsxs("div",{className:[o.ChatInput,x?o["ChatInput--editing"]:"",z?o["ChatInput--waitingForResponse"]:"",E?o.ChatInput__mobileView:"",E?g?o["ChatInput--mobileInitial"]:o["ChatInput--mobileWithMessages"]:""].filter(Boolean).join(" "),children:[S&&r.jsx("div",{className:o.ChatInput__error,role:"alert",children:S}),r.jsx("input",{type:"file",ref:C,style:{display:"none"},accept:"image/jpeg, image/png, image/gif, image/webp",multiple:!0,onChange:q}),r.jsx(t.Suspense,{fallback:null,children:r.jsx(a,{ref:w,value:y,onChange:F,onKeyDown:W,onPaste:$,placeholder:O,disabled:e,isEditing:x,isWaitingForResponse:z,selectedModel:m,onSendClick:N})}),r.jsx(t.Suspense,{fallback:null,children:r.jsx(l,{isMobile:E,isEditing:x,disabled:e,selectedModel:m,onNewChat:M,onUploadClick:B,onCancelEdit:H,onToggleModelSelector:v})})]})]})}));m.displayName="ChatInput";export{m as default};
//# sourceMappingURL=index-C-FADSuX.js.map
