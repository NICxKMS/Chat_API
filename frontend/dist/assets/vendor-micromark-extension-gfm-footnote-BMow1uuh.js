import{f as e}from"./vendor-micromark-factory-space-BuxqzSY_.js";import{n as t}from"./vendor-micromark-util-normalize-identifier-CzKtq1sx.js";import{b as n}from"./vendor-micromark-core-commonmark-CKya-DGW.js";function o(e){return null!==e&&(e<0||32===e)}const r={tokenize:function(t,n,o){const r=this;return e(t,(function(e){const t=r.events[r.events.length-1];return t&&"gfmFootnoteDefinitionIndent"===t[1].type&&4===t[2].sliceSerialize(t[1],!0).length?n(e):o(e)}),"gfmFootnoteDefinitionIndent",5)},partial:!0};function i(){return{document:{91:{tokenize:s,continuation:{tokenize:c},exit:u}},text:{91:{tokenize:l},93:{add:"after",tokenize:a,resolveTo:f}}}}function a(e,n,o){const r=this;let i=r.events.length;const a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let f;for(;i--;){const e=r.events[i][1];if("labelImage"===e.type){f=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return function(i){if(!f||!f._balanced)return o(i);const l=t(r.sliceSerialize({start:f.end,end:r.now()}));if(94!==l.codePointAt(0)||!a.includes(l.slice(1)))return o(i);return e.enter("gfmFootnoteCallLabelMarker"),e.consume(i),e.exit("gfmFootnoteCallLabelMarker"),n(i)}}function f(e,t){let n=e.length;for(;n--;)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const o={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},f=[e[n+1],e[n+2],["enter",o,t],e[n+3],e[n+4],["enter",r,t],["exit",r,t],["enter",i,t],["enter",a,t],["exit",a,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",o,t]];return e.splice(n,e.length-n+1,...f),e}function l(e,n,r){const i=this,a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let f,l=0;return function(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),s};function s(t){return 94!==t?r(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(s){if(l>999||93===s&&!f||null===s||91===s||o(s))return r(s);if(93===s){e.exit("chunkString");const o=e.exit("gfmFootnoteCallString");return a.includes(t(i.sliceSerialize(o)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(s),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),n):r(s)}return o(s)||(f=!0),l++,e.consume(s),92===s?u:c}function u(t){return 91===t||92===t||93===t?(e.consume(t),l++,c):c(t)}}function s(n,r,i){const a=this,f=a.parser.gfmFootnotes||(a.parser.gfmFootnotes=[]);let l,s,c=0;return function(e){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(e),n.exit("gfmFootnoteDefinitionLabelMarker"),u};function u(e){return 94===e?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(e),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",g):i(e)}function g(e){if(c>999||93===e&&!s||null===e||91===e||o(e))return i(e);if(93===e){n.exit("chunkString");const o=n.exit("gfmFootnoteDefinitionLabelString");return l=t(a.sliceSerialize(o)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(e),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),k}return o(e)||(s=!0),c++,n.consume(e),92===e?m:g}function m(e){return 91===e||92===e||93===e?(n.consume(e),c++,g):g(e)}function k(t){return 58===t?(n.enter("definitionMarker"),n.consume(t),n.exit("definitionMarker"),f.includes(l)||f.push(l),e(n,F,"gfmFootnoteDefinitionWhitespace")):i(t)}function F(e){return r(e)}}function c(e,t,o){return e.check(n,t,e.attempt(r,t,o))}function u(e){e.exit("gfmFootnoteDefinition")}export{i as g};
//# sourceMappingURL=vendor-micromark-extension-gfm-footnote-BMow1uuh.js.map
